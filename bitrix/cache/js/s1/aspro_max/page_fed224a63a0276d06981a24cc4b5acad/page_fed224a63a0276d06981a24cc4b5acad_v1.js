
; /* Start:"a:4:{s:4:"full";s:101:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/mustache.min.js?16297027225835";s:6:"source";s:82:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/mustache.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function e(t,r){if(typeof exports==="object"&&exports&&typeof exports.nodeName!=="string"){r(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],r)}else{t.Mustache={};r(t.Mustache)}})(this,function e(t){var r=Object.prototype.toString;var n=Array.isArray||function e(t){return r.call(t)==="[object Array]"};function i(e){return typeof e==="function"}function s(e){return n(e)?"array":typeof e}function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return e!=null&&typeof e==="object"&&t in e}var u=RegExp.prototype.test;function l(e,t){return u.call(e,t)}var f=/\S/;function c(e){return!l(f,e)}var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function h(e){return String(e).replace(/[&<>"'`=\/]/g,function e(t){return p[t]})}var v=/\s*/;var d=/\s+/;var g=/\s*=/;var w=/\s*\}/;var y=/#|\^|\/|>|\{|&|=|!/;function x(e,r){if(!e)return[];var i=[];var s=[];var o=[];var u=false;var l=false;function f(){if(u&&!l){while(o.length)delete s[o.pop()]}else{o=[]}u=false;l=false}var p,h,x;function E(e){if(typeof e==="string")e=e.split(d,2);if(!n(e)||e.length!==2)throw new Error("Invalid tags: "+e);p=new RegExp(a(e[0])+"\\s*");h=new RegExp("\\s*"+a(e[1]));x=new RegExp("\\s*"+a("}"+e[1]))}E(r||t.tags);var U=new m(e);var T,j,S,V,C,A;while(!U.eos()){T=U.pos;S=U.scanUntil(p);if(S){for(var I=0,R=S.length;I<R;++I){V=S.charAt(I);if(c(V)){o.push(s.length)}else{l=true}s.push(["text",V,T,T+1]);T+=1;if(V==="\n")f()}}if(!U.scan(p))break;u=true;j=U.scan(y)||"name";U.scan(v);if(j==="="){S=U.scanUntil(g);U.scan(g);U.scanUntil(h)}else if(j==="{"){S=U.scanUntil(x);U.scan(w);U.scanUntil(h);j="&"}else{S=U.scanUntil(h)}if(!U.scan(h))throw new Error("Unclosed tag at "+U.pos);C=[j,S,T,U.pos];s.push(C);if(j==="#"||j==="^"){i.push(C)}else if(j==="/"){A=i.pop();if(!A)throw new Error('Unopened section "'+S+'" at '+T);if(A[1]!==S)throw new Error('Unclosed section "'+A[1]+'" at '+T)}else if(j==="name"||j==="{"||j==="&"){l=true}else if(j==="="){E(S)}}A=i.pop();if(A)throw new Error('Unclosed section "'+A[1]+'" at '+U.pos);return b(k(s))}function k(e){var t=[];var r,n;for(var i=0,s=e.length;i<s;++i){r=e[i];if(r){if(r[0]==="text"&&n&&n[0]==="text"){n[1]+=r[1];n[3]=r[3]}else{t.push(r);n=r}}}return t}function b(e){var t=[];var r=t;var n=[];var i,s;for(var a=0,o=e.length;a<o;++a){i=e[a];switch(i[0]){case"#":case"^":r.push(i);n.push(i);r=i[4]=[];break;case"/":s=n.pop();s[5]=i[2];r=n.length>0?n[n.length-1][4]:t;break;default:r.push(i)}}return t}function m(e){this.string=e;this.tail=e;this.pos=0}m.prototype.eos=function e(){return this.tail===""};m.prototype.scan=function e(t){var r=this.tail.match(t);if(!r||r.index!==0)return"";var n=r[0];this.tail=this.tail.substring(n.length);this.pos+=n.length;return n};m.prototype.scanUntil=function e(t){var r=this.tail.search(t),n;switch(r){case-1:n=this.tail;this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r);this.tail=this.tail.substring(r)}this.pos+=n.length;return n};function E(e,t){this.view=e;this.cache={".":this.view};this.parent=t}E.prototype.push=function e(t){return new E(t,this)};E.prototype.lookup=function e(t){var r=this.cache;var n;if(r.hasOwnProperty(t)){n=r[t]}else{var s=this,a,u,l=false;while(s){if(t.indexOf(".")>0){n=s.view;a=t.split(".");u=0;while(n!=null&&u<a.length){if(u===a.length-1)l=o(n,a[u]);n=n[a[u++]]}}else{n=s.view[t];l=o(s.view,t)}if(l)break;s=s.parent}r[t]=n}if(i(n))n=n.call(this.view);return n};function U(){this.cache={}}U.prototype.clearCache=function e(){this.cache={}};U.prototype.parse=function e(r,n){var i=this.cache;var s=i[r];if(s==null)s=i[r+":"+(n||t.tags).join(":")]=x(r,n);return s};U.prototype.render=function e(t,r,n){var i=this.parse(t);var s=r instanceof E?r:new E(r);return this.renderTokens(i,s,n,t)};U.prototype.renderTokens=function e(t,r,n,i){var s="";var a,o,u;for(var l=0,f=t.length;l<f;++l){u=undefined;a=t[l];o=a[0];if(o==="#")u=this.renderSection(a,r,n,i);else if(o==="^")u=this.renderInverted(a,r,n,i);else if(o===">")u=this.renderPartial(a,r,n,i);else if(o==="&")u=this.unescapedValue(a,r);else if(o==="name")u=this.escapedValue(a,r);else if(o==="text")u=this.rawValue(a);if(u!==undefined)s+=u}return s};U.prototype.renderSection=function e(t,r,s,a){var o=this;var u="";var l=r.lookup(t[1]);function f(e){return o.render(e,r,s)}if(!l)return;if(n(l)){for(var c=0,p=l.length;c<p;++c){u+=this.renderTokens(t[4],r.push(l[c]),s,a)}}else if(typeof l==="object"||typeof l==="string"||typeof l==="number"){u+=this.renderTokens(t[4],r.push(l),s,a)}else if(i(l)){if(typeof a!=="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(r.view,a.slice(t[3],t[5]),f);if(l!=null)u+=l}else{u+=this.renderTokens(t[4],r,s,a)}return u};U.prototype.renderInverted=function e(t,r,i,s){var a=r.lookup(t[1]);if(!a||n(a)&&a.length===0)return this.renderTokens(t[4],r,i,s)};U.prototype.renderPartial=function e(t,r,n){if(!n)return;var s=i(n)?n(t[1]):n[t[1]];if(s!=null)return this.renderTokens(this.parse(s),r,n,s)};U.prototype.unescapedValue=function e(t,r){var n=r.lookup(t[1]);if(n!=null)return n};U.prototype.escapedValue=function e(r,n){var i=n.lookup(r[1]);if(i!=null)return t.escape(i)};U.prototype.rawValue=function e(t){return t[1]};t.name="mustache.js";t.version="2.3.0";t.tags=["{{","}}"];var T=new U;t.clearCache=function e(){return T.clearCache()};t.parse=function e(t,r){return T.parse(t,r)};t.render=function e(t,r,n){if(typeof t!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+s(t)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return T.render(t,r,n)};t.to_html=function e(r,n,s,a){var o=t.render(r,n,s);if(i(a)){a(o)}else{return o}};t.escape=h;t.Scanner=m;t.Context=E;t.Writer=U;return t});
/* End */
;
; /* Start:"a:4:{s:4:"full";s:104:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/action-pool.min.js?16297027224358";s:6:"source";s:85:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/action-pool.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Sale.BasketActionPool");BX.Sale.BasketActionPool=function(t){this.component=t;this.requestProcessing=false;this.updateTimer=null;this.isBasketRefreshed=this.component.params.DEFERRED_REFRESH!=="Y";this.needFullRecalculation=this.component.params.DEFERRED_REFRESH==="Y";this.pool={};this.lastActualPool={};this.approvedAction=["QUANTITY","DELETE","RESTORE","DELAY","OFFER","MERGE_OFFER"];this.switchTimer()};BX.Sale.BasketActionPool.prototype.setRefreshStatus=function(t){this.isBasketRefreshed=!!t};BX.Sale.BasketActionPool.prototype.getRefreshStatus=function(){return this.isBasketRefreshed};BX.Sale.BasketActionPool.prototype.isItemInPool=function(t){return!!this.pool[t]};BX.Sale.BasketActionPool.prototype.clearLastActualQuantityPool=function(t){this.lastActualPool[t]&&delete this.lastActualPool[t].QUANTITY};BX.Sale.BasketActionPool.prototype.checkItemPoolBefore=function(t){if(!t)return;this.pool[t]=this.pool[t]||{}};BX.Sale.BasketActionPool.prototype.checkItemPoolAfter=function(t){if(!t||!this.pool[t])return;if(Object.keys(this.pool[t]).length===0){delete this.pool[t]}};BX.Sale.BasketActionPool.prototype.addCoupon=function(t){this.pool.COUPON=t;this.switchTimer()};BX.Sale.BasketActionPool.prototype.removeCoupon=function(t){this.checkItemPoolBefore("REMOVE_COUPON");this.pool.REMOVE_COUPON[t]=t;this.switchTimer()};BX.Sale.BasketActionPool.prototype.changeQuantity=function(t,o,e){this.checkItemPoolBefore(t);if(this.lastActualPool[t]&&this.lastActualPool[t].QUANTITY!==o||!this.lastActualPool[t]&&o!==e){this.pool[t].QUANTITY=o}else{this.pool[t]&&delete this.pool[t].QUANTITY}this.checkItemPoolAfter(t);this.switchTimer()};BX.Sale.BasketActionPool.prototype.deleteItem=function(t){this.checkItemPoolBefore(t);if(this.pool[t].RESTORE){delete this.pool[t].RESTORE}else{this.pool[t].DELETE="Y"}this.checkItemPoolAfter(t);this.switchTimer()};BX.Sale.BasketActionPool.prototype.restoreItem=function(t,o){this.checkItemPoolBefore(t);if(this.pool[t].DELETE==="Y"){delete this.pool[t].DELETE}else{this.pool[t].RESTORE=o}this.checkItemPoolAfter(t);this.switchTimer()};BX.Sale.BasketActionPool.prototype.addDelayed=function(t){this.checkItemPoolBefore(t);this.pool[t].DELAY="Y";this.checkItemPoolAfter(t);this.switchTimer()};BX.Sale.BasketActionPool.prototype.removeDelayed=function(t){this.checkItemPoolBefore(t);this.pool[t].DELAY="N";this.checkItemPoolAfter(t);this.switchTimer()};BX.Sale.BasketActionPool.prototype.changeSku=function(t,o,e){if(JSON.stringify(o)!==JSON.stringify(e)){this.checkItemPoolBefore(t);this.pool[t].OFFER=o}else{this.pool[t]&&delete this.pool[t].OFFER;this.checkItemPoolAfter(t)}this.switchTimer()};BX.Sale.BasketActionPool.prototype.mergeSku=function(t){this.checkItemPoolBefore(t);this.pool[t].MERGE_OFFER="Y";this.switchTimer()};BX.Sale.BasketActionPool.prototype.switchTimer=function(){clearTimeout(this.updateTimer);if(this.isProcessing()){return}if(this.isPoolEmpty()){this.component.editPostponedBasketItems();this.component.fireCustomEvents()}if(!this.isPoolEmpty()){this.updateTimer=setTimeout(BX.proxy(this.trySendPool,this),300)}else if(!this.getRefreshStatus()){this.trySendPool()}};BX.Sale.BasketActionPool.prototype.trySendPool=function(){if(this.isPoolEmpty()&&this.getRefreshStatus()){return}this.doProcessing(true);if(!this.isPoolEmpty()){this.component.sendRequest("recalculateAjax",{basket:this.getPoolData()});this.lastActualPool=this.pool;this.pool={}}else if(!this.getRefreshStatus()){this.component.sendRequest("refreshAjax",{fullRecalculation:this.needFullRecalculation?"Y":"N"});this.needFullRecalculation=false}};BX.Sale.BasketActionPool.prototype.getPoolData=function(){var t={},o=this.pool;if(o.COUPON){t.coupon=o.COUPON;delete o.COUPON}if(o.REMOVE_COUPON){t.delete_coupon=o.REMOVE_COUPON;delete o.REMOVE_COUPON}for(var e in o){if(o.hasOwnProperty(e)){for(var i in o[e]){if(o[e].hasOwnProperty(i)&&BX.util.in_array(i,this.approvedAction)){t[i+"_"+e]=o[e][i]}}}}return t};BX.Sale.BasketActionPool.prototype.isPoolEmpty=function(){return Object.keys(this.pool).length===0};BX.Sale.BasketActionPool.prototype.doProcessing=function(t){this.requestProcessing=t===true;if(this.requestProcessing){this.component.startLoader()}else{this.component.endLoader()}};BX.Sale.BasketActionPool.prototype.isProcessing=function(){return this.requestProcessing===true}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:100:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/filter.min.js?162970272210511";s:6:"source";s:80:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/filter.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Sale.BasketFilter");BX.Sale.BasketFilter=function(t){this.component=t;this.activeFilterMode=false;this.filterTimer=null;this.mouseOverClearFilter=false;this.realShownItems=[];this.realSortedItems=[];this.realScrollTop=0;this.lastShownItemsHash="";this.currentFilter={query:"",similarHash:"",warning:false,notAvailable:false,delayed:false};if(this.component.useItemsFilter){this.bindEvents()}};BX.Sale.BasketFilter.prototype.bindEvents=function(){var t;var e=this.component.getEntity(this.component.getCacheNode(this.component.ids.itemListWrapper),"basket-filter");t=this.component.getEntity(e,"basket-filter-input");if(BX.type.isDomNode(t)){BX.bind(t,"focus",function(){e.style.flex=3});BX.bind(t,"blur",BX.delegate(function(){if(!this.mouseOverClearFilter){e.style.flex=""}},this));BX.bind(t,"keyup",BX.proxy(this.onFilterInput,this));BX.bind(t,"cut",BX.proxy(this.onFilterInput,this));BX.bind(t,"paste",BX.proxy(this.onFilterInput,this))}t=this.component.getEntity(e,"basket-filter-clear-btn");if(BX.type.isDomNode(t)){BX.bind(t,"mouseenter",BX.delegate(function(){this.mouseOverClearFilter=true},this));BX.bind(t,"mouseout",BX.delegate(function(){this.mouseOverClearFilter=false},this));BX.bind(t,"click",BX.delegate(function(){if(!this.filterInputEmpty()){this.clearFilterInput();this.onFilterChange()}e.style.flex=""},this))}};BX.Sale.BasketFilter.prototype.isActive=function(){return this.activeFilterMode};BX.Sale.BasketFilter.prototype.showFilterByName=function(t){if(!t)return;switch(t){case"not-available":this.showNotAvailableItemsFilter();break;case"delayed":this.showDelayItemsFilter();break;case"warning":this.showWarningItemsFilter();break;case"similar":this.showSimilarItemsFilter();break;case"all":default:this.clearAllFiltersExcept([]);this.onFilterChange()}};BX.Sale.BasketFilter.prototype.onFilterInput=function(){var t=BX.type.isDomNode(BX.proxy_context)?BX.util.trim(BX.proxy_context.value).toLowerCase():"";if(this.currentFilter.query!==t){this.currentFilter.query=t;this.onFilterChange()}};BX.Sale.BasketFilter.prototype.clearAllFiltersExcept=function(t){if(!t||!BX.type.isArray(t))return;!BX.util.in_array("input",t)&&this.clearFilterInput();!BX.util.in_array("warning",t)&&this.clearWarningItemsFilter();!BX.util.in_array("delayed",t)&&this.clearDelayItemsFilter();!BX.util.in_array("not-available",t)&&this.clearNotAvailableItemsFilter();if(!BX.util.in_array("similar",t)){this.clearSimilarItemsFilter();this.component.showSimilarCount(false)}};BX.Sale.BasketFilter.prototype.filterInputEmpty=function(){return this.currentFilter.query.length===0};BX.Sale.BasketFilter.prototype.clearFilterInput=function(){this.currentFilter.query="";var t=this.component.getEntity(this.component.getCacheNode(this.component.ids.itemListWrapper),"basket-filter-input");if(BX.type.isDomNode(t)){t.value=""}};BX.Sale.BasketFilter.prototype.addWarningItemsFilter=function(){this.currentFilter.warning=true};BX.Sale.BasketFilter.prototype.clearWarningItemsFilter=function(){this.currentFilter.warning=false};BX.Sale.BasketFilter.prototype.showWarningItemsFilter=function(){if(!this.currentFilter.warning){this.clearAllFiltersExcept(["warning"]);this.addWarningItemsFilter();this.onFilterChange()}};BX.Sale.BasketFilter.prototype.addDelayItemsFilter=function(){this.currentFilter.delayed=true};BX.Sale.BasketFilter.prototype.clearDelayItemsFilter=function(){this.currentFilter.delayed=false};BX.Sale.BasketFilter.prototype.showDelayItemsFilter=function(){if(!this.currentFilter.delayed){this.clearAllFiltersExcept(["delayed"]);this.addDelayItemsFilter();this.onFilterChange()}};BX.Sale.BasketFilter.prototype.addNotAvailableItemsFilter=function(){this.currentFilter.notAvailable=true};BX.Sale.BasketFilter.prototype.clearNotAvailableItemsFilter=function(){this.currentFilter.notAvailable=false};BX.Sale.BasketFilter.prototype.showNotAvailableItemsFilter=function(){if(!this.currentFilter.notAvailable){this.clearAllFiltersExcept(["not-available"]);this.addNotAvailableItemsFilter();this.onFilterChange()}};BX.Sale.BasketFilter.prototype.addSimilarItemsFilter=function(t){this.currentFilter.similarHash=t.HASH};BX.Sale.BasketFilter.prototype.clearSimilarItemsFilter=function(){this.currentFilter.similarHash=""};BX.Sale.BasketFilter.prototype.showSimilarItemsFilter=function(){var t=this.component.getItemDataByTarget(BX.proxy_context);if(this.currentFilter.similarHash!==t.HASH){this.clearAllFiltersExcept(["similar"]);this.addSimilarItemsFilter(t);this.onFilterChange()}};BX.Sale.BasketFilter.prototype.getTimeoutDuration=function(){return this.component.duration.filterTimer};BX.Sale.BasketFilter.prototype.onFilterChange=function(){this.component.showItemsOverlay();if(this.currentFilter.query.length||this.currentFilter.similarHash.length||this.currentFilter.warning||this.currentFilter.notAvailable||this.currentFilter.delayed){clearTimeout(this.filterTimer);this.filterTimer=setTimeout(BX.proxy(this.enableFilterMode,this),this.getTimeoutDuration())}else{this.disableFilterMode()}};BX.Sale.BasketFilter.prototype.enableFilterMode=function(){var t;if(!this.activeFilterMode){this.activeFilterMode=true;this.realShownItems=BX.util.array_values(this.component.shownItems);this.realSortedItems=BX.util.array_values(this.component.sortedItems);this.realScrollTop=this.component.getDocumentScrollTop()}this.component.scrollToFirstItem();this.component.sortedItems=this.searchItems();t=JSON.stringify(this.component.sortedItems);if(this.lastShownItemsHash!==t){this.lastShownItemsHash=t;this.component.deleteBasketItems(BX.util.array_values(this.component.shownItems),false);if(this.component.sortedItems.length){this.component.initializeBasketItems();this.hideEmptyFilterResult()}else{this.showEmptyFilterResult()}if(this.currentFilter.similarHash.length){this.component.showSimilarCount(true)}}else{this.highlightFoundItems()}this.component.hideItemsOverlay()};BX.Sale.BasketFilter.prototype.disableFilterMode=function(){clearTimeout(this.filterTimer);this.lastShownItemsHash="";if(this.activeFilterMode){this.activeFilterMode=false;this.component.sortedItems=BX.util.array_values(this.realSortedItems);this.component.deleteBasketItems(BX.util.array_values(this.component.shownItems),false);this.hideEmptyFilterResult();this.component.editBasketItems(BX.util.array_values(this.realShownItems));window.scrollTo(0,this.realScrollTop)}this.component.hideItemsOverlay()};BX.Sale.BasketFilter.prototype.searchItems=function(){var t=[];for(var e=0;e<this.realSortedItems.length;e++){var i=this.component.items[this.realSortedItems[e]];if(i&&this.searchItemMatch(i)){t.push(i.ID)}}return t};BX.Sale.BasketFilter.prototype.highlightFoundItems=function(){if(!this.activeFilterMode)return;for(var t in this.component.shownItems){if(this.component.shownItems.hasOwnProperty(t)){this.highlightSearchMatch(this.component.items[this.component.shownItems[t]])}}};BX.Sale.BasketFilter.prototype.searchItemMatch=function(t){var e=false,i=false;if(this.currentFilter.notAvailable){i=!!t.NOT_AVAILABLE;if(!i){return e}}else if(this.currentFilter.delayed){i=!!t.DELAYED;if(!i){return e}}else if(this.currentFilter.warning){i=BX.util.in_array(t.ID,this.component.warningItems);if(!i){return e}}else if(BX.type.isNotEmptyString(this.currentFilter.similarHash)){i=this.currentFilter.similarHash===t.HASH;if(!i){return e}}if(BX.type.isNotEmptyString(this.currentFilter.query)){if(t.NAME.toLowerCase().indexOf(this.currentFilter.query)!==-1){e="NAME"}if(!e){var r=parseFloat(this.currentFilter.query);if(!isNaN(r)){if(parseFloat(t.PRICE)===r){e="PRICE"}else if(parseFloat(t.SUM_PRICE)===r){e="SUM_PRICE"}}}if(!e&&this.currentFilter.query.length>=3){if(t.PRICE_FORMATED.toLowerCase().indexOf(this.currentFilter.query)!==-1){e="PRICE"}else if(t.SUM_PRICE_FORMATED.toLowerCase().indexOf(this.currentFilter.query)!==-1){e="SUM_PRICE"}}var s,l;if(!e&&t.PROPS.length){for(s in t.PROPS){if(t.PROPS.hasOwnProperty(s)&&BX.type.isNotEmptyString(t.PROPS[s].VALUE)){l=t.PROPS[s].VALUE.toLowerCase();if(l===this.currentFilter.query||this.currentFilter.query.length>=3&&l.indexOf(this.currentFilter.query)!==-1){e="PROPS";break}}}}if(!e&&t.COLUMN_LIST.length){for(s in t.COLUMN_LIST){if(t.COLUMN_LIST.hasOwnProperty(s)&&BX.type.isNotEmptyString(t.COLUMN_LIST[s].VALUE)){l=t.COLUMN_LIST[s].VALUE.toLowerCase();if(l===this.currentFilter.query||this.currentFilter.query.length>=3&&l.indexOf(this.currentFilter.query)!==-1){e="COLUMNS";break}}}}}else if(i){e=true}return e};BX.Sale.BasketFilter.prototype.highlightSearchMatch=function(t){var e=this.searchItemMatch(t);if(e){var i,r,s,l;switch(e){case"NAME":i=this.component.getEntity(BX(this.component.ids.item+t.ID),"basket-item-name");if(BX.type.isDomNode(i)){i.innerHTML=t.NAME.replace(new RegExp("(.*)("+this.currentFilter.query.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+")(.*)","gi"),function(t,e,i,r){return BX.util.htmlspecialchars(e)+'<span class="basket-item-highlighted">'+BX.util.htmlspecialchars(i)+"</span>"+BX.util.htmlspecialchars(r)})}break;case"PRICE":i=BX(this.component.ids.price+t.ID);BX.addClass(i,"basket-item-highlighted");break;case"SUM_PRICE":i=BX(this.component.ids.sumPrice+t.ID);BX.addClass(i,"basket-item-highlighted");break;case"PROPS":i=this.component.getEntities(BX(this.component.ids.item+t.ID),"basket-item-property-value");for(r=0;r<i.length;r++){l=i[r].getAttribute("data-property-code");for(s in t.PROPS){if(t.PROPS.hasOwnProperty(s)&&t.PROPS[s].CODE===l){i[r].innerHTML=t.PROPS[s].VALUE.replace(new RegExp("("+this.currentFilter.query+")","gi"),'<span class="basket-item-highlighted">$1</span>')}}}break;case"COLUMNS":i=this.component.getEntities(BX(this.component.ids.item+t.ID),"basket-item-property-column-value");for(r=0;r<i.length;r++){l=i[r].getAttribute("data-column-property-code");for(s in t.COLUMN_LIST){if(t.COLUMN_LIST.hasOwnProperty(s)&&t.COLUMN_LIST[s].CODE===l){i[r].innerHTML=t.COLUMN_LIST[s].VALUE.replace(new RegExp("("+this.currentFilter.query+")","gi"),'<span class="basket-item-highlighted">$1</span>')}}}break}}};BX.Sale.BasketFilter.prototype.showEmptyFilterResult=function(){var t=this.component.getCacheNode(this.component.ids.itemList);if(BX.type.isDomNode(t)&&t.clientHeight>=500){var e=this.component.getCacheNode(this.component.ids.itemListEmptyResult);if(BX.type.isDomNode(e)){e.style.display=""}}};BX.Sale.BasketFilter.prototype.hideEmptyFilterResult=function(){var t=this.component.getCacheNode(this.component.ids.itemListEmptyResult);if(BX.type.isDomNode(t)){t.style.display="none"}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:103:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/component.min.js?162970272248354";s:6:"source";s:83:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/component.js";s:3:"min";s:87:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/component.min.js";s:3:"map";s:91:"/bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/component.min.js.map";}"*/
!function(){"use strict";BX.namespace("BX.Sale.BasketComponent"),BX.Sale.BasketComponent={maxItemsShowCount:30,precisionFactor:Math.pow(10,6),stickyHeaderOffset:0,duration:{priceAnimation:300,filterTimer:300},ids:{item:"basket-item-",quantity:"basket-item-quantity-",price:"basket-item-price-",sumPrice:"basket-item-sum-price-",sumPriceOld:"basket-item-sum-price-old-",sumPriceDiff:"basket-item-sum-price-difference-",itemHeightAligner:"basket-item-height-aligner-",total:"basket-total-price",basketRoot:"basket-root",itemListWrapper:"basket-items-list-wrapper",itemListContainer:"basket-items-list-container",itemList:"basket-item-list",itemListTable:"basket-item-table",itemListEmptyResult:"basket-item-list-empty-result",itemListOverlay:"basket-items-list-overlay",warning:"basket-warning",itemServices:"basket-services-item-"},initializePrimaryFields:function(){this.templates={},this.nodes={},this.items={},this.sortedItems=[],this.shownItems=[],this.changedItems=[],this.postponedItems=[],this.warningItems=[],this.isMobile=BX.browser.IsMobile(),this.isTouch=BX.hasClass(document.documentElement,"bx-touch"),this.lastAction="initialLoad",this.coupons=null,this.imagePopup=null,this.loadingScreen=null,this.quantityDelay=null,this.quantityTimer=null},init:function(parameters){this.initializePrimaryFields(),this.params=parameters.params||{},this.template=parameters.template||"",this.signedParamsString=parameters.signedParamsString||"",this.siteId=parameters.siteId||"",this.siteTemplateId=parameters.siteTemplateId||"",this.ajaxUrl=this.params.AJAX_PATH||"",this.templateFolder=parameters.templateFolder||"",this.useDynamicScroll="Y"===this.params.USE_DYNAMIC_SCROLL,this.useItemsFilter="Y"===this.params.SHOW_FILTER&&!this.isMobile,this.initializeFilter(),this.applyBasketResult(parameters.result),this.initializeActionPool(),this.useItemsFilter&&(this.checkHeaderDisplay(),this.bindHeaderEvents()),this.initializeBasketItems(),this.editTotal(),this.editWarnings(),this.getCacheNode(this.ids.basketRoot).style.opacity=1,this.bindInitialEvents(),this.resizeServicesBasketTimeout()},getTemplate:function(templateName){if(!this.templates.hasOwnProperty(templateName)){var template=BX(templateName);this.templates[templateName]=BX.type.isDomNode(template)?template.innerHTML:""}return this.templates[templateName]},getCacheNode:function(id){return this.nodes.hasOwnProperty(id)||(this.nodes[id]=BX(id)),this.nodes[id]},getEntity:function(parent,entity,additionalFilter){return parent&&entity?(additionalFilter=additionalFilter||"",parent.querySelector(additionalFilter+'[data-entity="'+entity+'"]')):null},getEntities:function(parent,entity,additionalFilter){return parent&&entity?(additionalFilter=additionalFilter||"",parent.querySelectorAll(additionalFilter+'[data-entity="'+entity+'"]')):{length:0}},bindInitialEvents:function(){this.bindWarningEvents(),BX.bind(window,"scroll",BX.proxy(this.checkStickyHeaders,this)),BX.bind(window,"scroll",BX.proxy(this.lazyLoad,this)),BX.bind(window,"resize",BX.throttle(this.checkStickyHeaders,20,this)),BX.bind(window,"resize",BX.proxy(this.resizeServicesBasket,this))},bindWarningEvents:function(){var showItemsNode=this.getEntity(BX(this.ids.warning),"basket-items-warning-count");BX.type.isDomNode(showItemsNode)&&(showItemsNode.style.display="",BX.bind(showItemsNode,"click",BX.delegate((function(){this.toggleFilter("warning")}),this))),BX.bind(this.getEntity(BX(this.ids.warning),"basket-items-warning-notification-close"),"click",BX.proxy(this.removeAllWarnings,this))},toggleFilter:function(event){var target=BX.type.isNotEmptyString(event)?this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="'+event+'"]'):BX.getEventTarget(event);if(BX.type.isDomNode(target)&&!BX.hasClass(target,"active")){for(var entityName=target.getAttribute("data-filter"),entities=target.parentNode.querySelectorAll("[data-filter]"),i=0;i<entities.length;i++)entities[i].getAttribute("data-filter")===entityName?BX.addClass(entities[i],"active"):BX.hasClass(entities[i],"active")&&BX.removeClass(entities[i],"active");this.filter.showFilterByName(entityName)}},scrollToFirstItem:function(){var headerNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-list-header");if(BX.type.isDomNode(headerNode)){var itemListTopPosition=BX.pos(this.getCacheNode(this.ids.itemListContainer)).top,headerBottomPosition;itemListTopPosition<BX.pos(headerNode).bottom&&window.scrollTo(0,itemListTopPosition-this.stickyHeaderOffset)}},showItemsOverlay:function(){var overlay=this.getCacheNode(this.ids.itemListOverlay);BX.type.isDomNode(overlay)&&(overlay.style.display="")},hideItemsOverlay:function(){var overlay=this.getCacheNode(this.ids.itemListOverlay);BX.type.isDomNode(overlay)&&(overlay.style.display="none")},checkHeaderDisplay:function(){var header=this.getCacheNode(this.ids.itemListWrapper);BX.type.isDomNode(header)&&BX.removeClass(header,"basket-items-list-wrapper-light")},bindHeaderEvents:function(){for(var entities=this.getEntities(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count"),i=0;i<entities.length;i++)BX.bind(entities[i],"click",BX.proxy(this.toggleFilter,this))},checkStickyHeaders:function(){if(!this.isMobile){var node,position,border=2,offset=0,scrollTop=this.getDocumentScrollTop(),basketPosition,basketScrolledToEnd=scrollTop+200>=BX.pos(this.getCacheNode(this.ids.basketRoot)).bottom;if(BX.util.in_array("top",this.params.TOTAL_BLOCK_DISPLAY)){var totalBlockNode=this.getEntity(this.getCacheNode(this.ids.basketRoot),"basket-total-block");BX.type.isDomNode(totalBlockNode)&&(node=this.getEntity(totalBlockNode,"basket-checkout-aligner"),BX.type.isDomNode(node)&&(scrollTop>=(position=BX.pos(totalBlockNode)).top?(offset+=node.clientHeight,BX.hasClass(node,"basket-checkout-container-fixed")||(totalBlockNode.style.height=position.height+"px",node.style.width=node.clientWidth+2+"px",BX.addClass(node,"basket-checkout-container-fixed"))):BX.hasClass(node,"basket-checkout-container-fixed")&&(totalBlockNode.style.height="",node.style.width="",BX.removeClass(node,"basket-checkout-container-fixed")),basketScrolledToEnd?BX.hasClass(node,"basket-checkout-container-fixed-hide")||BX.addClass(node,"basket-checkout-container-fixed-hide"):BX.hasClass(node,"basket-checkout-container-fixed-hide")&&BX.removeClass(node,"basket-checkout-container-fixed-hide")))}if(this.useItemsFilter){var itemWrapperNode=this.getCacheNode(this.ids.itemListWrapper);node=this.getEntity(itemWrapperNode,"basket-items-list-header"),BX.type.isDomNode(node)&&(scrollTop+offset>=(position=BX.pos(itemWrapperNode)).top&&!basketScrolledToEnd?(BX.hasClass(node,"basket-items-list-header-fixed")||(node.style.width=node.clientWidth+2+"px",itemWrapperNode.style.paddingTop=node.clientHeight+"px",BX.addClass(node,"basket-items-list-header-fixed")),offset&&(node.style.top=offset+"px"),offset+=node.clientHeight):BX.hasClass(node,"basket-items-list-header-fixed")&&(itemWrapperNode.style.paddingTop="",node.style.width="",node.style.top="",BX.removeClass(node,"basket-items-list-header-fixed")))}this.stickyHeaderOffset=offset}},resizeServicesBasketTimeout:function($time){void 0===$time&&($time=10),setTimeout(BX.delegate((function(){this.resizeServicesBasket()}),this),$time)},resizeServicesBasket:function(){var servicesPriceBlock=$(".services_in_basket_page .services-item__cost"),servicesBlock=$(".services_in_basket_page");if(window.matchMedia("(min-width: 768px)").matches){var widthColumnPrice=$("tr:not(.hidden-basket-services) .basket-items-list-item-price:not(.basket-items-list-item-price-for-one):eq(0)").width(),paddingPriceCol=9;servicesPriceBlock.length&&(servicesPriceBlock.width(widthColumnPrice-9),servicesPriceBlock.css("max-width",widthColumnPrice-9+"px"),$(".services_in_basket_page .services-item__info").css("max-width","calc(100% - "+widthColumnPrice-9+")")),servicesBlock.length&&servicesBlock.removeClass("services_opacity")}else servicesPriceBlock.length&&($(".services_in_basket_page .services-item__cost").css("width",""),$(".services_in_basket_page .services-item__cost").css("max-width",""),$(".services_in_basket_page .services-item__info").css("max-width",""))},getDocumentScrollTop:function(){return window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0)},lazyLoad:function(){var itemsNodePosition=BX.pos(this.getCacheNode(this.ids.itemListContainer));if(this.getDocumentScrollTop()+window.innerHeight>=itemsNodePosition.bottom-400){var itemIds=this.getItemsAfter();itemIds.length&&this.editBasketItems(itemIds)}},fireCustomEvents:function(){"Y"===this.result.EVENT_ONCHANGE_ON_START&&BX.onCustomEvent("OnBasketChange"),"Y"!==this.params.HIDE_COUPON&&(null!==this.coupons&&this.coupons!==this.result.COUPON_LIST&&BX.onCustomEvent("OnCouponApply"),this.coupons=this.result.COUPON_LIST)},editTotal:function(){this.fillTotalBlocks(),this.showItemsCount(),this.showWarningItemsCount(),this.showNotAvailableItemsCount(),this.showDelayedItemsCount()},fillTotalBlocks:function(){var totalNodes=this.getEntities(this.getCacheNode(this.ids.basketRoot),"basket-total-block");if(totalNodes&&totalNodes.length){var totalTemplate=this.getTemplate("basket-total-template");if(totalTemplate){var totalRender=this.render(totalTemplate,this.result.TOTAL_RENDER_DATA);for(var i in totalNodes)totalNodes.hasOwnProperty(i)&&BX.type.isDomNode(totalNodes[i])&&(totalNodes[i].innerHTML=totalRender,this.bindTotalEvents(totalNodes[i]))}}this.checkStickyHeaders()},showItemsCount:function(){var itemCountNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="all"]');BX.type.isDomNode(itemCountNode)&&(itemCountNode.innerHTML=BX.message("SBB_IN_BASKET")+" "+this.result.BASKET_ITEMS_COUNT+" "+this.getGoodsMessage(this.result.BASKET_ITEMS_COUNT),itemCountNode.style.display="")},showSimilarCount:function(state){var itemCountNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="similar"]');BX.type.isDomNode(itemCountNode)&&(state?(itemCountNode.innerHTML=this.sortedItems.length+" "+this.getGoodsMessage(this.result.BASKET_ITEMS_COUNT,"SBB_SIMILAR_ITEM"),itemCountNode.style.display=""):itemCountNode.style.display="none")},showWarningItemsCount:function(){var itemCountNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="warning"]');BX.type.isDomNode(itemCountNode)&&(this.warningItems.length?(itemCountNode.innerHTML=this.warningItems.length+" "+BX.message("SBB_BASKET_ITEMS_WARNING"),itemCountNode.style.display=""):itemCountNode.style.display="none")},showNotAvailableItemsCount:function(){var itemCountNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="not-available"]');BX.type.isDomNode(itemCountNode)&&(parseInt(this.result.NOT_AVAILABLE_BASKET_ITEMS_COUNT)?(itemCountNode.innerHTML=this.result.NOT_AVAILABLE_BASKET_ITEMS_COUNT+" "+this.getGoodsMessage(this.result.NOT_AVAILABLE_BASKET_ITEMS_COUNT,"SBB_NOT_AVAILABLE_ITEM"),itemCountNode.style.display=""):itemCountNode.style.display="none")},showDelayedItemsCount:function(){var itemCountNode=this.getEntity(this.getCacheNode(this.ids.itemListWrapper),"basket-items-count",'[data-filter="delayed"]');BX.type.isDomNode(itemCountNode)&&(parseInt(this.result.DELAYED_BASKET_ITEMS_COUNT)?(itemCountNode.innerHTML=this.result.DELAYED_BASKET_ITEMS_COUNT+" "+this.getGoodsMessage(this.result.DELAYED_BASKET_ITEMS_COUNT,"SBB_DELAYED_ITEM"),itemCountNode.style.display=""):itemCountNode.style.display="none")},getGoodsMessage:function(count,customMessage){var mesCode,countReminder=count>10&&count<20?0:count%10;return mesCode=1===countReminder?customMessage||"SBB_GOOD":countReminder>=2&&countReminder<=4?customMessage?customMessage+"_2":"SBB_GOOD_2":customMessage?customMessage+"S":"SBB_GOODS",BX.message(mesCode)},bindTotalEvents:function(node){this.result.TOTAL_RENDER_DATA.DISABLE_CHECKOUT||BX.bind(this.getEntity(node,"basket-checkout-button"),"click",BX.proxy(this.checkOutAction,this)),BX.bind(this.getEntity(node,"basket-coupon-input"),"change",BX.proxy(this.addCouponAction,this)),BX.bind(this.getEntity(node,"basket-coupon-input"),"paste",BX.proxy(this.pasteCouponAction,this));for(var couponNodes=this.getEntities(node,"basket-coupon-delete"),i=0,l=couponNodes.length;i<l;i++)BX.bind(couponNodes[i],"click",BX.proxy(this.removeCouponAction,this))},checkOutAction:function(){document.location.href=this.params.PATH_TO_ORDER},addCouponAction:function(event){var target=BX.getEventTarget(event);target&&target.value&&(this.actionPool.addCoupon(target.value),target.disabled=!0)},pasteCouponAction:function(event){setTimeout(BX.delegate((function(){this.addCouponAction(event)}),this),10)},removeCouponAction:function(){var value=BX.proxy_context&&BX.util.trim(BX.proxy_context.getAttribute("data-coupon"));value&&this.actionPool.removeCoupon(value)},initializeActionPool:function(){this.actionPool=new BX.Sale.BasketActionPool(this)},initializeFilter:function(){this.filter=new BX.Sale.BasketFilter(this)},sendRequest:function(action,data){this.lastAction=action,"recalculateAjax"===this.lastAction&&(data.lastAppliedDiscounts=BX.util.array_keys(this.result.FULL_DISCOUNT_LIST).join(","),"Y"===this.params.USE_ENHANCED_ECOMMERCE&&this.checkAnalytics(data)),BX.ajax({method:"POST",dataType:"json",url:this.ajaxUrl,data:this.getData(data),onsuccess:BX.delegate((function(result){this.actionPool.doProcessing(!1),BX.type.isPlainObject(result)&&(this.actionPool.setRefreshStatus(result.BASKET_REFRESHED),result.RESTORED_BASKET_ITEMS&&this.restoreBasketItems(result.RESTORED_BASKET_ITEMS),result.DELETED_BASKET_ITEMS&&this.deleteBasketItems(result.DELETED_BASKET_ITEMS,"Y"===this.params.SHOW_RESTORE),result.MERGED_BASKET_ITEMS&&this.deleteBasketItems(result.MERGED_BASKET_ITEMS,!1,!0),this.applyBasketResult(result.BASKET_DATA),this.editBasketItems(this.getItemsToEdit()),this.resizeServicesBasketTimeout(),this.editTotal(),this.applyPriceAnimation(),this.editWarnings(),this.actionPool.switchTimer(),this.isBasketIntegrated()&&this.isBasketChanged()&&BX.Sale.OrderAjaxComponent.sendRequest())}),this),onfailure:BX.delegate((function(){this.actionPool.doProcessing(!1)}),this)})},isBasketIntegrated:function(){return"Y"===this.params.BASKET_WITH_ORDER_INTEGRATION},isBasketChanged:function(){return this.changedItems.length},addPriceAnimationData:function(nodeId,start,finish,currency){BX.type.isPlainObject(this.priceAnimationData)||this.clearPriceAnimationData(),this.priceAnimationData.start[nodeId]=parseFloat(start),this.priceAnimationData.finish[nodeId]=parseFloat(finish),this.priceAnimationData.currency[nodeId]=currency,this.priceAnimationData.int[nodeId]=parseFloat(start)===parseInt(start)&&parseFloat(finish)===parseInt(finish)},clearPriceAnimationData:function(){this.priceAnimationData={start:{},finish:{},currency:{},int:{}}},applyBasketResult:function(result){if(this.changedItems=[],this.clearPriceAnimationData(),BX.type.isPlainObject(result)){if(result.BASKET_ITEM_RENDER_DATA){var i,newData;for(i in result.BASKET_ITEM_RENDER_DATA)if(result.BASKET_ITEM_RENDER_DATA.hasOwnProperty(i)){if((newData=result.BASKET_ITEM_RENDER_DATA[i]).WARNINGS=this.checkBasketItemWarnings(newData,result.WARNING_MESSAGE_WITH_CODE),this.items[newData.ID]){if(JSON.stringify(this.items[newData.ID])===JSON.stringify(newData))continue}else this.addSortedItem(newData.ID,!0);this.changedItems.push(newData.ID),newData=this.checkBasketItemsAnimation(newData),this.items[newData.ID]=newData}this.changedItems=BX.util.array_unique(this.changedItems.concat(this.getChangedSimilarOffers())),this.isBasketChanged()&&this.sortSortedItems(!0)}result.TOTAL_RENDER_DATA&&(result.TOTAL_RENDER_DATA=this.checkTotalAnimation(result.TOTAL_RENDER_DATA)),this.result=result}},itemSortFunction:function(a,b){return this.items.hasOwnProperty(a)&&this.items.hasOwnProperty(b)?parseFloat(this.items[a].SORT)-parseFloat(this.items[b].SORT):0},getChangedSimilarOffers:function(){var changedSimilarOffers=[],otherSimilarItemsQuantity,totalSimilarItemsQuantity,hashMap=this.getHashMap();for(var hash in hashMap)if(hashMap.hasOwnProperty(hash))if(hashMap[hash].length>1)for(var i=0;i<hashMap[hash].length;i++){otherSimilarItemsQuantity=0,totalSimilarItemsQuantity=0;for(var k=0;k<hashMap[hash].length;k++)hashMap[hash][k]!=hashMap[hash][i]&&(otherSimilarItemsQuantity+=parseFloat(this.items[hashMap[hash][k]].QUANTITY)),totalSimilarItemsQuantity+=parseFloat(this.items[hashMap[hash][k]].QUANTITY);this.items[hashMap[hash][i]].HAS_SIMILAR_ITEMS&&this.items[hashMap[hash][i]].SIMILAR_ITEMS_QUANTITY==otherSimilarItemsQuantity&&this.items[hashMap[hash][i]].TOTAL_SIMILAR_ITEMS_QUANTITY==totalSimilarItemsQuantity||(changedSimilarOffers.push(hashMap[hash][i]),this.items[hashMap[hash][i]].HAS_SIMILAR_ITEMS=!0,this.items[hashMap[hash][i]].SIMILAR_ITEMS_QUANTITY=otherSimilarItemsQuantity,this.items[hashMap[hash][i]].TOTAL_SIMILAR_ITEMS_QUANTITY=totalSimilarItemsQuantity,this.items[hashMap[hash][i]].ALL_AVAILABLE_QUANTITY=this.items[hashMap[hash][i]].AVAILABLE_QUANTITY,this.items[hashMap[hash][i]].AVAILABLE_QUANTITY=this.items[hashMap[hash][i]].ALL_AVAILABLE_QUANTITY-otherSimilarItemsQuantity)}else hashMap[hash][0]&&this.items[hashMap[hash][0]].HAS_SIMILAR_ITEMS&&(changedSimilarOffers.push(hashMap[hash][0]),delete this.items[hashMap[hash][0]].HAS_SIMILAR_ITEMS,delete this.items[hashMap[hash][0]].SIMILAR_ITEMS_QUANTITY,delete this.items[hashMap[hash][0]].TOTAL_SIMILAR_ITEMS_QUANTITY,this.items[hashMap[hash][0]].AVAILABLE_QUANTITY=this.items[hashMap[hash][0]].ALL_AVAILABLE_QUANTITY,delete this.items[hashMap[hash][0]].ALL_AVAILABLE_QUANTITY);return changedSimilarOffers},getHashMap:function(){var hashMap={};for(var id in this.items)this.items.hasOwnProperty(id)&&this.isItemAvailable(id)&&(hashMap.hasOwnProperty(this.items[id].HASH)||(hashMap[this.items[id].HASH]=[]),hashMap[this.items[id].HASH].push(id));return hashMap},isItemAvailable:function(itemId){var sortedItems=this.filter.isActive()?this.filter.realSortedItems:this.sortedItems;return!this.items[itemId].NOT_AVAILABLE&&!this.items[itemId].SHOW_RESTORE&&BX.util.in_array(itemId,sortedItems)},checkTotalAnimation:function(totalData){return this.result&&this.result.TOTAL_RENDER_DATA&&parseFloat(this.result.TOTAL_RENDER_DATA.PRICE)>parseFloat(totalData.PRICE)&&(totalData.PRICE_NEW=totalData.PRICE,totalData.PRICE=this.result.TOTAL_RENDER_DATA.PRICE,totalData.PRICE_FORMATED_NEW=totalData.PRICE_FORMATED,totalData.PRICE_FORMATED=this.result.TOTAL_RENDER_DATA.PRICE_FORMATED,this.addPriceAnimationData(this.ids.total,totalData.PRICE,totalData.PRICE_NEW,totalData.CURRENCY)),totalData},checkBasketItemsAnimation:function(itemData){var itemId=itemData.ID;if(this.items[itemId]){var quantityNode=BX(this.ids.quantity+itemId);BX.type.isDomNode(quantityNode)&&!this.actionPool.isItemInPool(itemId)&&parseFloat(quantityNode.value)!==parseFloat(itemData.QUANTITY)&&(itemData.QUANTITY_ANIMATION=!0,this.actionPool.clearLastActualQuantityPool(itemId)),parseFloat(this.items[itemId].PRICE)>parseFloat(itemData.PRICE)&&(itemData.PRICE_NEW=itemData.PRICE,itemData.PRICE=this.items[itemId].PRICE,itemData.PRICE_FORMATED_NEW=itemData.PRICE_FORMATED,itemData.PRICE_FORMATED=this.items[itemId].PRICE_FORMATED,this.addPriceAnimationData(this.ids.price+itemId,itemData.PRICE,itemData.PRICE_NEW,itemData.CURRENCY)),BX.util.in_array("SUM",this.params.COLUMNS_LIST)&&parseFloat(this.items[itemId].SUM_PRICE)>parseFloat(itemData.SUM_PRICE)&&parseFloat(this.items[itemId].QUANTITY)===parseFloat(itemData.QUANTITY)&&(itemData.SUM_PRICE_NEW=itemData.SUM_PRICE,itemData.SUM_PRICE=this.items[itemId].SUM_PRICE,itemData.SUM_PRICE_FORMATED_NEW=itemData.SUM_PRICE_FORMATED,itemData.SUM_PRICE_FORMATED=this.items[itemId].SUM_PRICE_FORMATED,this.addPriceAnimationData(this.ids.sumPrice+itemId,itemData.SUM_PRICE,itemData.SUM_PRICE_NEW,itemData.CURRENCY))}return itemData},getData:function(data){return(data=data||{})[this.params.ACTION_VARIABLE]=this.lastAction,data.via_ajax="Y",data.site_id=this.siteId,data.site_template_id=this.siteTemplateId,data.sessid=BX.bitrix_sessid(),data.template=this.template,data.signedParamsString=this.signedParamsString,data},startLoader:function(){},endLoader:function(){},editWarnings:function(){this.editGeneralWarnings(),this.editBasketItemWarnings(),this.toggleWarningBlock(),this.showWarningItemsCount()},editGeneralWarnings:function(){var warningsNode=this.getEntity(this.getCacheNode(this.ids.warning),"basket-general-warnings");if(BX.type.isDomNode(warningsNode)){var generalWarningText=warningsNode.innerHTML;if(this.result.WARNING_MESSAGE_WITH_CODE)for(var code in this.result.WARNING_MESSAGE_WITH_CODE)this.result.WARNING_MESSAGE_WITH_CODE.hasOwnProperty(code)&&(this.items[code]||-1!==generalWarningText.indexOf(this.result.WARNING_MESSAGE_WITH_CODE[code])||(generalWarningText+=this.result.WARNING_MESSAGE_WITH_CODE[code]+"<br/>"));generalWarningText?(warningsNode.innerHTML=generalWarningText,warningsNode.style.display=""):(warningsNode.style.display="none",warningsNode.innerHTML="")}},editBasketItemWarnings:function(){var itemsWarningsNode=this.getEntity(this.getCacheNode(this.ids.warning),"basket-item-warnings");if(BX.type.isDomNode(itemsWarningsNode))if(this.warningItems.length){var warningCount=this.getEntity(itemsWarningsNode,"basket-items-warning-count");BX.type.isDomNode(warningCount)&&(warningCount.innerHTML=this.warningItems.length+" "+this.getGoodsMessage(this.warningItems.length)),itemsWarningsNode.style.display=""}else"none"!==itemsWarningsNode.style.display&&(itemsWarningsNode.style.display="none",this.filter.isActive()&&this.toggleFilter("all"))},toggleWarningBlock:function(){var warningNode=this.getCacheNode(this.ids.warning);if(BX.type.isDomNode(warningNode)){var generalWarningNode=this.getEntity(warningNode,"basket-general-warnings"),itemsWarningsNode=this.getEntity(warningNode,"basket-item-warnings");BX.type.isDomNode(generalWarningNode)&&"none"!==generalWarningNode.style.display||BX.type.isDomNode(itemsWarningsNode)&&"none"!==itemsWarningsNode.style.display?warningNode.style.display="":warningNode.style.display="none"}},checkBasketItemWarnings:function(itemData,warnings){if(itemData){var itemWarnings;if(itemWarnings=this.items[itemData.ID]&&"refreshAjax"===this.lastAction?this.items[itemData.ID].WARNINGS:[],BX.type.isArray(warnings[itemData.ID])&&warnings[itemData.ID].length)for(var i in warnings[itemData.ID])warnings[itemData.ID].hasOwnProperty(i)&&!BX.util.in_array(warnings[itemData.ID][i],itemWarnings)&&itemWarnings.push(warnings[itemData.ID][i]);return itemWarnings.length?BX.util.in_array(itemData.ID,this.warningItems)||this.warningItems.push(itemData.ID):BX.util.in_array(itemData.ID,this.warningItems)&&this.warningItems.splice(BX.util.array_search(itemData.ID,this.warningItems),1),itemWarnings}},removeAllWarnings:function(event){this.clearGeneralWarnings(),this.clearBasketItemsWarnings(),this.editWarnings(),event&&event.preventDefault()},clearGeneralWarnings:function(){this.result.WARNING_MESSAGE_WITH_CODE={};var generalWarningNode=this.getEntity(this.getCacheNode(this.ids.warning),"basket-general-warnings");BX.type.isDomNode(generalWarningNode)&&(generalWarningNode.innerHTML="")},clearBasketItemsWarnings:function(){var itemsToEdit=[];for(var i in this.warningItems)this.warningItems.hasOwnProperty(i)&&(this.items[this.warningItems[i]].WARNINGS=[],this.isItemShown(this.warningItems[i])&&itemsToEdit.push(this.warningItems[i]));this.warningItems=[],this.editBasketItems(itemsToEdit)},isItemShown:function(itemId){return BX.util.in_array(itemId,this.shownItems)},initializeBasketItems:function(){if(0!==Object.keys(this.items).length)for(var i=0;i<this.sortedItems.length&&!(this.useDynamicScroll&&this.shownItems.length>=this.maxItemsShowCount);i++)this.createBasketItem(this.sortedItems[i])},createBasketItem:function(itemId){if(this.items[itemId]){var basketItemTemplate=this.getTemplate("basket-item-template");if(basketItemTemplate){var basketItemHtml=this.renderBasketItem(basketItemTemplate,this.items[itemId]),sortIndex=BX.util.array_search(itemId,this.sortedItems);this.shownItems.length&&sortIndex>=0?sortIndex<BX.util.array_search(this.shownItems[0],this.sortedItems)?(BX(this.ids.item+this.shownItems[0]).insertAdjacentHTML("beforebegin",basketItemHtml),this.shownItems.unshift(itemId)):sortIndex>BX.util.array_search(this.shownItems[this.shownItems.length-1],this.sortedItems)?(BX.type.isDomNode(BX(this.ids.itemServices+this.shownItems[this.shownItems.length-1]))?BX(this.ids.itemServices+this.shownItems[this.shownItems.length-1]).insertAdjacentHTML("afterend",basketItemHtml):BX(this.ids.item+this.shownItems[this.shownItems.length-1]).insertAdjacentHTML("afterend",basketServicesHtml),this.shownItems.push(itemId)):(BX(this.ids.item+this.sortedItems[sortIndex+1]).insertAdjacentHTML("beforebegin",basketItemHtml),this.shownItems.splice(sortIndex+1,0,itemId)):(this.getCacheNode(this.ids.itemListTable).insertAdjacentHTML("beforeend",basketItemHtml),this.shownItems.push(itemId)),this.bindBasketItemEvents(this.items[itemId]),this.filter.isActive()&&this.filter.highlightSearchMatch(this.items[itemId])}}},getItemsToEdit:function(){var itemIds=[];if(this.isBasketChanged())for(var i in this.changedItems)this.changedItems.hasOwnProperty(i)&&this.isItemShown(this.changedItems[i])&&itemIds.push(this.changedItems[i]);return itemIds},getItemsAfter:function(){var itemIdsAfter=[];if(this.useDynamicScroll){var lastShownItemId=this.shownItems[this.shownItems.length-1]||!1;if(lastShownItemId)for(var i=0,index=BX.util.array_search(lastShownItemId,this.sortedItems);this.sortedItems[++index]&&i++<this.maxItemsShowCount;)itemIdsAfter.push(this.sortedItems[index])}return itemIdsAfter},editBasketItems:function(itemIds){var i,item;if(itemIds&&0!==itemIds.length)for(i in itemIds)itemIds.hasOwnProperty(i)&&BX.type.isPlainObject(this.items[itemIds[i]])&&(item=this.items[itemIds[i]],this.actionPool.isItemInPool(item.ID)?BX.util.in_array(item.ID,this.postponedItems)||this.postponedItems.push(item.ID):BX.type.isDomNode(BX(this.ids.item+item.ID))?(this.redrawBasketItemNode(item.ID),this.applyQuantityAnimation(item.ID)):this.createBasketItem(item.ID))},editPostponedBasketItems:function(){if(this.postponedItems.length){var itemsToEdit=[];for(var i in this.postponedItems)this.postponedItems.hasOwnProperty(i)&&this.isItemShown(this.postponedItems[i])&&itemsToEdit.push(this.postponedItems[i]);this.postponedItems=[],this.editBasketItems(itemsToEdit)}},applyQuantityAnimation:function(itemId){var basketItemNode=BX(this.ids.item+itemId);BX.type.isDomNode(basketItemNode)&&this.items[itemId]&&this.items[itemId].QUANTITY_ANIMATION&&BX.addClass(BX(this.ids.quantity+itemId),"basket-updated")},applyPriceAnimation:function(){if(this.priceAnimationData&&0!==Object.keys(this.priceAnimationData.start).length){var animationData=this.priceAnimationData,nodeCache={};new BX.easing({duration:"Y"===this.params.USE_PRICE_ANIMATION?this.duration.priceAnimation:1,start:animationData.start,finish:animationData.finish,transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate((function(state){for(var nodeId in animationData.start)if(animationData.start.hasOwnProperty(nodeId)){if(!nodeCache[nodeId])if(nodeId===this.ids.total)nodeCache[nodeId]=this.getEntities(this.getCacheNode(this.ids.basketRoot),this.ids.total);else{var node=BX(nodeId);nodeCache[nodeId]=node?[node]:[]}animationData.int[nodeId]||(state[nodeId]=(state[nodeId]+state[nodeId]%1e3/1e3).toFixed(5));for(var i=0;i<nodeCache[nodeId].length;i++)nodeCache[nodeId][i].innerHTML=this.getFormatPrice(state[nodeId],animationData.currency[nodeId])}}),this),complete:BX.delegate((function(){var nodeId,formattedPrice,itemId,type;for(nodeId in animationData.start)if(animationData.start.hasOwnProperty(nodeId)){formattedPrice=this.getFormatPrice(animationData.finish[nodeId],animationData.currency[nodeId]);for(var i=0;i<nodeCache[nodeId].length;i++)nodeCache[nodeId][i].innerHTML=formattedPrice;-1!==nodeId.indexOf(this.ids.sumPrice)?(type="SUM_PRICE",itemId=nodeId.substr(this.ids.sumPrice.length)):-1!==nodeId.indexOf(this.ids.price)?(type="PRICE",itemId=nodeId.substr(this.ids.price.length)):-1!==nodeId.indexOf(this.ids.total)?(type="TOTAL",itemId=""):(itemId="",type=""),BX.type.isNotEmptyString(type)&&(itemId?(this.items[itemId][type]=animationData.finish[nodeId],delete this.items[itemId][type+"_NEW"],this.items[itemId][type+"_FORMATED"]=formattedPrice,delete this.items[itemId][type+"_FORMATED_NEW"]):"TOTAL"===type&&(this.result.TOTAL_RENDER_DATA.PRICE=animationData.finish[nodeId],delete this.result.TOTAL_RENDER_DATA.PRICE_NEW,this.result.TOTAL_RENDER_DATA.PRICE_FORMATED=formattedPrice,delete this.result.TOTAL_RENDER_DATA.PRICE_FORMATED_NEW))}this.filter.highlightFoundItems()}),this)}).animate()}},getFormatPrice:function(price,currency){return BX.Currency.currencyFormat(price,currency,!0)},deleteBasketItems:function(items,restore,final){if(items&&items.length)for(var i in items)items.hasOwnProperty(i)&&this.deleteBasketItem(items[i],restore,final)},deleteBasketItem:function(itemId,restore,final){this.items[itemId].NOT_AVAILABLE&&restore&&(restore=!1,final=!0),restore?(this.items[itemId].SHOW_RESTORE=!0,this.items[itemId].SHOW_LOADING=!1,this.redrawBasketItemNode(itemId)):(this.changeShownItem(itemId),BX.remove(BX(this.ids.item+itemId)),BX.remove(BX(this.ids.itemServices+itemId))),final&&(this.changeSortedItem(itemId,!1,!0),this.changeShownItem(itemId,!1,!0))},addSortedItem:function(itemId,all){this.sortedItems.push(itemId.toString()),all&&this.filter.isActive()&&this.filter.realSortedItems.push(itemId.toString())},changeSortedItem:function(itemId,newItemId,all){var index=BX.util.array_search(itemId,this.sortedItems);index>=0&&(newItemId?this.sortedItems.splice(index,1,newItemId.toString()):this.sortedItems.splice(index,1)),all&&this.filter.isActive()&&(index=BX.util.array_search(itemId,this.filter.realSortedItems))>=0&&(newItemId?this.filter.realSortedItems.splice(index,1,newItemId.toString()):this.filter.realSortedItems.splice(index,1))},sortSortedItems:function(all){this.sortedItems.sort(BX.proxy(this.itemSortFunction,this)),all&&this.filter.isActive()&&this.filter.realSortedItems.sort(BX.proxy(this.itemSortFunction,this))},changeShownItem:function(itemId,newItemId,all){var index=BX.util.array_search(itemId,this.shownItems);index>=0&&(newItemId?this.shownItems.splice(index,1,newItemId.toString()):this.shownItems.splice(index,1)),all&&this.filter.isActive()&&(index=BX.util.array_search(itemId,this.filter.realShownItems))>=0&&(newItemId?this.filter.realShownItems.splice(index,1,newItemId.toString()):this.filter.realShownItems.splice(index,1)),this.resizeServicesBasketTimeout()},redrawBasketItemNode:function(itemId){var basketItemNode=BX(this.ids.item+itemId),basketServicesNode=BX(this.ids.itemServices+itemId);if(this.items[itemId]&&BX.type.isDomNode(basketItemNode)){var basketItemTemplate=this.getTemplate("basket-item-template");if(basketItemTemplate){var nodeAligner=BX(this.ids.itemHeightAligner+itemId),oldHeight;BX.type.isDomNode(nodeAligner)&&(oldHeight=nodeAligner.clientHeight);var basketItemHtml=this.renderBasketItem(basketItemTemplate,this.items[itemId]);basketItemNode.insertAdjacentHTML("beforebegin",basketItemHtml),BX.remove(basketItemNode),BX.remove(basketServicesNode),oldHeight&&(nodeAligner=BX(this.ids.itemHeightAligner+itemId),BX.type.isDomNode(nodeAligner)&&nodeAligner.clientHeight<oldHeight&&(nodeAligner.style.minHeight=oldHeight+"px",setTimeout((function(){nodeAligner.style.minHeight="0px"}),1))),this.bindBasketItemEvents(this.items[itemId]),this.filter.isActive()&&this.filter.highlightSearchMatch(this.items[itemId])}}},restoreBasketItems:function(items){var oldItemId,newItemId,basketItemNode,basketServicesNode;if(items&&0!==Object.keys(items).length)for(oldItemId in items)items.hasOwnProperty(oldItemId)&&(newItemId=items[oldItemId],this.isItemShown(oldItemId)&&(this.changeShownItem(oldItemId,newItemId,!0),basketItemNode=BX(this.ids.item+oldItemId),basketServicesNode=BX(this.ids.itemServices+oldItemId),BX.type.isDomNode(basketItemNode)&&(basketItemNode.id=this.ids.item+newItemId,basketItemNode.setAttribute("data-id",newItemId)),BX.type.isDomNode(basketServicesNode)&&(basketServicesNode.id=this.ids.itemServices+newItemId,basketServicesNode.setAttribute("data-id",newItemId))),this.changeSortedItem(oldItemId,!1,!0))},bindBasketItemEvents:function(itemData){if(itemData){var itemNode=BX(this.ids.item+itemData.ID);BX.type.isDomNode(itemNode)&&(this.bindQuantityEvents(itemNode,itemData),this.bindSkuEvents(itemNode,itemData),this.bindImageEvents(itemNode,itemData),this.bindActionEvents(itemNode,itemData),this.bindRestoreAction(itemNode,itemData),this.bindItemWarningEvents(itemNode,itemData))}},bindQuantityEvents:function(node,data){if(node&&data&&this.isItemAvailable(data.ID)){var entity,block=this.getEntity(node,"basket-item-quantity-block");if(block){var startEventName=this.isTouch?"touchstart":"mousedown",endEventName=this.isTouch?"touchend":"mouseup";entity=this.getEntity(block,"basket-item-quantity-minus"),BX.bind(entity,startEventName,BX.proxy(this.startQuantityInterval,this)),BX.bind(entity,endEventName,BX.proxy(this.clearQuantityInterval,this)),BX.bind(entity,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(entity,"click",BX.proxy(this.quantityMinus,this)),entity=this.getEntity(block,"basket-item-quantity-plus"),BX.bind(entity,startEventName,BX.proxy(this.startQuantityInterval,this)),BX.bind(entity,endEventName,BX.proxy(this.clearQuantityInterval,this)),BX.bind(entity,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(entity,"click",BX.proxy(this.quantityPlus,this)),entity=this.getEntity(block,"basket-item-quantity-field"),BX.bind(entity,"change",BX.proxy(this.quantityChange,this))}}},startQuantityInterval:function(){var target=BX.proxy_context,func="basket-item-quantity-minus"===target.getAttribute("data-entity")?BX.proxy(this.quantityMinus,this):BX.proxy(this.quantityPlus,this);this.quantityDelay=setTimeout(BX.delegate((function(){this.quantityTimer=setInterval((function(){func(target)}),150)}),this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay),clearInterval(this.quantityTimer)},quantityPlus:function(target){BX.type.isDomNode(target)||(target=BX.proxy_context,this.clearQuantityInterval());var itemData=this.getItemDataByTarget(target);if(itemData){var quantityField=BX(this.ids.quantity+itemData.ID),isQuantityFloat=this.isQuantityFloat(itemData),currentQuantity=isQuantityFloat?parseFloat(quantityField.value):Math.round(quantityField.value),measureRatio=isQuantityFloat?parseFloat(itemData.MEASURE_RATIO):parseInt(itemData.MEASURE_RATIO),quantity=parseFloat((currentQuantity+measureRatio).toFixed(5));quantity=this.getCorrectQuantity(itemData,quantity),this.setQuantity(itemData,quantity)}},quantityMinus:function(target){target=BX.type.isDomNode(target)?target:BX.proxy_context;var itemData=this.getItemDataByTarget(target);if(itemData){var quantityField=BX(this.ids.quantity+itemData.ID),isQuantityFloat=this.isQuantityFloat(itemData),currentQuantity=isQuantityFloat?parseFloat(quantityField.value):Math.round(quantityField.value),measureRatio=isQuantityFloat?parseFloat(itemData.MEASURE_RATIO):parseInt(itemData.MEASURE_RATIO),quantity=parseFloat((currentQuantity-measureRatio).toFixed(5));quantity=this.getCorrectQuantity(itemData,quantity),this.setQuantity(itemData,quantity)}},quantityChange:function(){var itemData=this.getItemDataByTarget(BX.proxy_context),quantityField,quantity;itemData&&(quantityField=BX(this.ids.quantity+itemData.ID),quantity=this.getCorrectQuantity(itemData,quantityField.value),this.setQuantity(itemData,quantity))},isQuantityFloat:function(item){return"Y"===this.params.QUANTITY_FLOAT||parseInt(item.MEASURE_RATIO)!==parseFloat(item.MEASURE_RATIO)},getCorrectQuantity:function(itemData,quantity){var isQuantityFloat=this.isQuantityFloat(itemData),measureRatio=isQuantityFloat?parseFloat(itemData.MEASURE_RATIO):parseInt(itemData.MEASURE_RATIO),availableQuantity=0;(quantity=(isQuantityFloat?parseFloat(quantity):parseInt(quantity,10))||0)<0&&(quantity=0),measureRatio>0&&quantity<measureRatio&&(quantity=measureRatio),"Y"===itemData.CHECK_MAX_QUANTITY&&(availableQuantity=isQuantityFloat?parseFloat(itemData.AVAILABLE_QUANTITY):parseInt(itemData.AVAILABLE_QUANTITY))>0&&quantity>availableQuantity&&(quantity=availableQuantity);var reminder=(quantity/measureRatio-(quantity/measureRatio).toFixed(0)).toFixed(5),remain;return 0===parseFloat(reminder)?quantity:(0!==measureRatio&&1!==measureRatio&&(remain=quantity*this.precisionFactor%(measureRatio*this.precisionFactor)/this.precisionFactor,measureRatio>0&&remain>0&&(remain>=measureRatio/2&&(0===availableQuantity||quantity+measureRatio-remain<=availableQuantity)?quantity+=measureRatio-remain:quantity-=remain)),quantity=isQuantityFloat?parseFloat(quantity):parseInt(quantity,10))},setQuantity:function(itemData,quantity){var quantityField=BX(this.ids.quantity+itemData.ID),currentQuantity;quantityField&&(quantity=parseFloat(quantity),currentQuantity=parseFloat(quantityField.getAttribute("data-value")),quantityField.value=quantity,parseFloat(itemData.QUANTITY)!==parseFloat(quantity)&&(this.animatePriceByQuantity(itemData,quantity),this.actionPool.changeQuantity(itemData.ID,quantity,currentQuantity)))},animatePriceByQuantity:function(itemData,quantity){var priceNode=BX(this.ids.sumPrice+itemData.ID);if(BX.type.isDomNode(priceNode)){var quantityMultiplier=quantity/parseFloat(itemData.MEASURE_RATIO),startPrice=parseFloat(itemData.SUM_PRICE),finalPrice=parseFloat(itemData.PRICE)*quantityMultiplier,isInt=parseInt(startPrice)===parseFloat(startPrice)&&parseInt(finalPrice)===parseFloat(finalPrice);startPrice!==finalPrice&&(this.items[itemData.ID].QUANTITY=quantity,this.items[itemData.ID].SUM_PRICE=finalPrice,new BX.easing({duration:"Y"===this.params.USE_PRICE_ANIMATION?this.duration.priceAnimation:1,start:{price:startPrice},finish:{price:finalPrice},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate((function(state){isInt||(state.price=(state.price+state.price%1e3/1e3).toFixed(5)),priceNode.innerHTML=this.getFormatPrice(state.price,itemData.CURRENCY)}),this),complete:BX.delegate((function(){var node,price;priceNode.innerHTML=this.getFormatPrice(finalPrice,itemData.CURRENCY),node=BX(this.ids.sumPriceOld+itemData.ID),BX.type.isDomNode(node)&&(price=parseFloat(itemData.FULL_PRICE)*quantityMultiplier,node.innerHTML=this.getFormatPrice(price,itemData.CURRENCY)),node=BX(this.ids.sumPriceDiff+itemData.ID),BX.type.isDomNode(node)&&(price=parseFloat(itemData.DISCOUNT_PRICE)*quantityMultiplier,node.innerHTML=this.getFormatPrice(price,itemData.CURRENCY))}),this)}).animate())}},getItemDataByTarget:function(target){var data=!1,id,itemNode=BX.findParent(target,{attrs:{"data-entity":"basket-item"}});return itemNode&&(id=itemNode.getAttribute("data-id"),data=this.items[id]),data},bindSkuEvents:function(node,data){if(node&&data){var blocks=this.getEntities(node,"basket-item-sku-block"),blockEntities,i,l,ii,ll;for(i=0,l=blocks.length;i<l;i++)for(ii=0,ll=(blockEntities=this.getEntities(blocks[i],"basket-item-sku-field")).length;ii<ll;ii++)BX.bind(blockEntities[ii],"click",BX.proxy(this.changeSku,this))}},changeSku:function(){var i,l,target=BX.proxy_context;if(!BX.hasClass(target,"selected")){var itemData=this.getItemDataByTarget(target);if(itemData){var basketItemNode=BX(this.ids.item+itemData.ID);if(basketItemNode){var currentSkuListNodes=this.getEntities(target.parentNode,"basket-item-sku-field");for(i=0,l=currentSkuListNodes.length;i<l;i++)currentSkuListNodes[i].isEqualNode(target)?BX.addClass(currentSkuListNodes[i],"selected"):BX.removeClass(currentSkuListNodes[i],"selected");this.actionPool.changeSku(itemData.ID,this.getSkuPropertyValues(basketItemNode),this.getInitialSkuPropertyValues(basketItemNode))}this.deleteServices(itemData)}}},getSkuPropertyValues:function(basketItemNode){for(var propertyValues={},propNodes=this.getEntities(basketItemNode,"basket-item-sku-field",".selected"),i=0,l=propNodes.length;i<l;i++)propertyValues[propNodes[i].getAttribute("data-property")]=BX.util.htmlspecialcharsback(propNodes[i].getAttribute("data-value-id"));return propertyValues},getInitialSkuPropertyValues:function(basketItemNode){for(var propertyValues={},propNodes=this.getEntities(basketItemNode,"basket-item-sku-field",'[data-initial="true"]'),i=0,l=propNodes.length;i<l;i++)propertyValues[propNodes[i].getAttribute("data-property")]=BX.util.htmlspecialcharsback(propNodes[i].getAttribute("data-value-id"));return propertyValues},bindImageEvents:function(node,data){if(node&&data)for(var images=node.querySelectorAll(".basket-item-custom-block-photo-item"),i=0,l=images.length;i<l;i++)BX.bind(images[i],"click",BX.proxy(this.showPropertyImagePopup,this))},showPropertyImagePopup:function(){var target,propertyCode,imageIndex,item,imageSrc,i;if(target=BX.proxy_context,item=this.getItemDataByTarget(target),propertyCode=target.getAttribute("data-column-property-code"),imageIndex=target.getAttribute("data-image-index"),item&&item.COLUMN_LIST)for(i in item.COLUMN_LIST)if(item.COLUMN_LIST.hasOwnProperty(i)&&item.COLUMN_LIST[i].CODE===propertyCode&&item.COLUMN_LIST[i].VALUE[imageIndex]){imageSrc=item.COLUMN_LIST[i].VALUE[imageIndex].IMAGE_SRC_ORIGINAL;break}if(imageSrc){this.imagePopup&&this.imagePopup.destroy();var imageId="bx-soa-image-popup-content",that=this;this.imagePopup=new BX.PopupWindow("bx-soa-image-popup",null,{lightShadow:!0,offsetTop:0,offsetLeft:0,closeIcon:{top:"3px",right:"10px"},autoHide:!0,bindOptions:{position:"bottom"},closeByEsc:!0,zIndex:100,events:{onPopupShow:function(){BX.create("IMG",{props:{src:imageSrc},events:{load:function(){var content=BX(imageId);if(content){var windowSize=BX.GetWindowInnerSize(),ratio=that.isMobile?.5:.9,contentHeight,contentWidth;BX.cleanNode(content),content.appendChild(this),contentHeight=content.offsetHeight,contentWidth=content.offsetWidth,contentHeight>windowSize.innerHeight*ratio&&(content.style.height=windowSize.innerHeight*ratio+"px",content.style.width=contentWidth*(windowSize.innerHeight*ratio/contentHeight)+"px",contentHeight=content.offsetHeight,contentWidth=content.offsetWidth),contentWidth>windowSize.innerWidth*ratio&&(content.style.width=windowSize.innerWidth*ratio+"px",content.style.height=contentHeight*(windowSize.innerWidth*ratio/contentWidth)+"px"),content.style.height=content.offsetHeight+"px",content.style.width=content.offsetWidth+"px",that.imagePopup.adjustPosition()}}}})},onPopupClose:function(){this.destroy()}},content:BX.create("DIV",{props:{id:imageId}})}),this.imagePopup.show()}},bindActionEvents:function(node,data){if(node&&data){var entity;if(BX.util.in_array("DELETE",this.params.COLUMNS_LIST))for(var i=0,l=(entity=this.getEntities(node,"basket-item-delete")).length;i<l;i++)BX.bind(entity[i],"click",BX.proxy(this.deleteAction,this)),BX.bind(entity[i],"click",BX.proxy(this.deleteServicesAction,this));BX.util.in_array("DELAY",this.params.COLUMNS_LIST)&&(entity=this.getEntity(node,"basket-item-add-delayed"),BX.bind(entity,"click",BX.proxy(this.addDelayedAction,this))),entity=this.getEntity(node,"basket-item-remove-delayed"),BX.bind(entity,"click",BX.proxy(this.removeDelayedAction,this)),entity=this.getEntity(node,"basket-item-merge-sku-link"),BX.bind(entity,"click",BX.proxy(this.mergeAction,this)),entity=this.getEntity(node,"basket-item-show-similar-link"),BX.bind(entity,"click",BX.delegate((function(){this.toggleFilter("similar")}),this))}},deleteAction:function(){var itemData=this.getItemDataByTarget(BX.proxy_context);itemData&&(this.actionPool.deleteItem(itemData.ID),this.items[itemData.ID].SHOW_LOADING=!0,"Y"===this.params.SHOW_RESTORE&&this.isItemAvailable(itemData.ID)&&(this.items[itemData.ID].SHOW_RESTORE=!0),this.redrawBasketItemNode(itemData.ID))},deleteServicesAction:function(){var itemData=this.getItemDataByTarget(BX.proxy_context);itemData&&this.deleteServices(itemData)},deleteServices:function(itemData){itemData&&$.ajax({url:arAsproOptions.SITE_DIR+"ajax/item.php?delete_linked_services="+itemData.PRODUCT_ID,type:"post",success:function(html){updateBasketInfoServices(!1),getActualBasket()}})},addDelayedAction:function(){var itemData=this.getItemDataByTarget(BX.proxy_context);itemData&&(this.actionPool.addDelayed(itemData.ID),this.items[itemData.ID].SHOW_LOADING=!0,this.redrawBasketItemNode(itemData.ID))},removeDelayedAction:function(){var itemData=this.getItemDataByTarget(BX.proxy_context);itemData&&(this.actionPool.removeDelayed(itemData.ID),this.items[itemData.ID].SHOW_LOADING=!0,this.redrawBasketItemNode(itemData.ID))},mergeAction:function(){var itemData=this.getItemDataByTarget(BX.proxy_context);itemData&&this.actionPool.mergeSku(itemData.ID)},bindRestoreAction:function(node,itemData){node&&itemData&&"Y"===this.params.SHOW_RESTORE&&(BX.bind(this.getEntity(node,"basket-item-restore-button"),"click",BX.delegate((function(){this.actionPool.restoreItem(itemData.ID,{PRODUCT_ID:itemData.PRODUCT_ID,QUANTITY:itemData.QUANTITY,PROPS:itemData.PROPS_ALL,SORT:itemData.SORT,MODULE:itemData.MODULE,PRODUCT_PROVIDER_CLASS:itemData.PRODUCT_PROVIDER_CLASS}),this.items[itemData.ID].SHOW_RESTORE=!1,this.items[itemData.ID].SHOW_LOADING=!0,this.redrawBasketItemNode(itemData.ID)}),this)),BX.bind(this.getEntity(node,"basket-item-close-restore-button"),"click",BX.delegate((function(){this.deleteBasketItem(itemData.ID,!1,!0)}),this)))},bindItemWarningEvents:function(node,data){node&&data&&BX.bind(this.getEntity(BX(this.ids.item+data.ID),"basket-item-warning-close"),"click",BX.proxy(this.closeItemWarnings,this))},closeItemWarnings:function(){var target=BX.proxy_context;if(BX.type.isDomNode(target)){var itemData=this.getItemDataByTarget(target);this.items[itemData.ID].WARNINGS=[],this.warningItems.splice(BX.util.array_search(itemData.ID,this.warningItems),1),this.redrawBasketItemNode(itemData.ID),this.editWarnings()}},renderBasketItem:function(template,data){var clonedData=BX.clone(data);return BX.type.isPlainObject(clonedData)&&(clonedData.USE_FILTER=this.useItemsFilter&&!this.filter.currentFilter.similarHash.length),Mustache.render(template,clonedData)},render:function(template,data){return Mustache.render(template,data)},checkAnalytics:function(data){if(data&&data.basket){var itemId,itemsDiff={};for(var i in data.basket)data.basket.hasOwnProperty(i)&&(i.indexOf("QUANTITY_")>=0?(itemId=i.substr(9),this.items[itemId]&&(itemsDiff[itemId]=parseFloat(data.basket[i])-parseFloat(BX(this.ids.quantity+itemId).getAttribute("data-value")))):i.indexOf("DELETE_")>=0?(itemId=i.substr(7),this.items[itemId]&&(itemsDiff[itemId]=-parseFloat(this.items[itemId].QUANTITY))):i.indexOf("RESTORE_")>=0&&(itemId=i.substr(8),this.items[itemId]&&(itemsDiff[itemId]=parseFloat(this.items[itemId].QUANTITY))));this.setAnalyticsDataLayer(itemsDiff)}},setAnalyticsDataLayer:function(itemsDiff){if(itemsDiff&&0!==Object.keys(itemsDiff).length){window[this.params.DATA_LAYER_NAME]=window[this.params.DATA_LAYER_NAME]||[];var plus=[],minus=[];for(var itemId in itemsDiff)itemsDiff.hasOwnProperty(itemId)&&(itemsDiff[itemId]>0?plus.push(this.getItemAnalyticsInfo(itemId,itemsDiff[itemId])):itemsDiff[itemId]<0&&minus.push(this.getItemAnalyticsInfo(itemId,itemsDiff[itemId])));plus.length&&window[this.params.DATA_LAYER_NAME].push({event:"addToCart",ecommerce:{currencyCode:this.items[itemId].CURRENCY||"",add:{products:plus}}}),minus.length&&window[this.params.DATA_LAYER_NAME].push({event:"removeFromCart",ecommerce:{currencyCode:this.items[itemId].CURRENCY||"",remove:{products:minus}}})}},getItemAnalyticsInfo:function(itemId,diff){if(!this.items[itemId])return{};for(var brand=(this.items[itemId].BRAND||"").split(",  ").join("/"),variants=[],selectedSku=this.getEntities(BX(this.ids.item+itemId),"basket-item-sku-field",".selected"),i=0,l=selectedSku.length;i<l;i++)variants.push(selectedSku[i].getAttribute("data-sku-name"));return{name:this.items[itemId].NAME||"",id:this.items[itemId].PRODUCT_ID||"",price:this.items[itemId].PRICE||0,brand:brand,variant:variants.join("/"),quantity:Math.abs(diff)}}}}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:105:"/bitrix/templates/aspro_max/components/bitrix/catalog.bigdata.products/main/script.min.js?162970272223267";s:6:"source";s:85:"/bitrix/templates/aspro_max/components/bitrix/catalog.bigdata.products/main/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
function getCookie(t){var s=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return s?decodeURIComponent(s[1]):void 0}function bx_rcm_recommendation_event_attaching(t){return null}function bx_rcm_adaptive_recommendation_event_attaching(t,s){var e=function(s){var e,i=BX(this);for(e in t)if(t[e].productUrl==i.getAttribute("href")){window.JCCatalogBigdataProducts.prototype.RememberProductRecommendation(t[e].recommendationId,t[e].productId);break}},i=BX(s);i||(i=document.body);var o,a=BX.findChildren(i,{tag:"a"},!0);if(a)for(o in a)BX.bind(a[o],"click",e)}function bx_rcm_get_from_cloud(t,s,e){var i="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",o=BX.ajax.prepareData(s);o&&(i+=(-1!==i.indexOf("?")?"&":"?")+o);var a=function(s){s.items||(s.items=[]),BX.ajax({url:"/bitrix/components/bitrix/catalog.bigdata.products/ajax.php?"+BX.ajax.prepareData({AJAX_ITEMS:s.items,RID:s.id}),method:"POST",data:e,dataType:"html",processData:!1,start:!0,onsuccess:function(s){var e=BX.processHTML(s);BX(t).innerHTML=e.HTML,BX.ajax.processScripts(e.SCRIPT),InitOwlSlider(),InitLazyLoad(),void 0!==window.stickySidebar&&window.stickySidebar.updateSticky()}})};BX.ajax({method:"GET",dataType:"json",url:i,timeout:3,onsuccess:a,onfailure:a})}(function(t){if(!t.JCCatalogBigdataProducts){var s=function(t){s.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"bx_medium bx_bt_button",id:this.id},text:t.text}),this.buttonNode=BX.create("span",{attrs:{className:t.ownerClass},style:{marginBottom:"0",borderBottom:"0 none transparent"},children:[this.nameNode],events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(s,BX.PopupWindowButton),t.JCCatalogBigdataProducts=function(t){if(this.productType=0,this.showQuantity=!0,this.showAbsent=!0,this.secondPict=!1,this.showOldPrice=!1,this.showPercent=!1,this.showSkuProps=!1,this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:""},this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:""},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:""},this.defaultPict={pict:null,secondPict:null},this.checkQuantity=!1,this.maxQuantity=0,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.canSubscription=!0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.offers=[],this.offerNum=0,this.treeProps=[],this.obTreeRows=[],this.showCount=[],this.showStart=[],this.selectedValues={},this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPict=null,this.obSecondPict=null,this.obPrice=null,this.obTree=null,this.obBuyBtn=null,this.obDscPerc=null,this.obSecondDscPerc=null,this.obSkuProps=null,this.obMeasure=null,this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.treeRowShowSize=5,this.treeEnableArrow={display:"",cursor:"pointer",opacity:1},this.treeDisableArrow={display:"",cursor:"default",opacity:.2},this.lastElement=!1,this.containerHeight=0,this.errorCode=0,"object"==typeof t){switch(this.productType=parseInt(t.PRODUCT_TYPE,10),this.showQuantity=t.SHOW_QUANTITY,this.showAbsent=t.SHOW_ABSENT,this.secondPict=!!t.SECOND_PICT,this.showOldPrice=!!t.SHOW_OLD_PRICE,this.showPercent=!!t.SHOW_DISCOUNT_PERCENT,this.showSkuProps=!!t.SHOW_SKU_PROPS,this.visual=t.VISUAL,this.productType){case 1:case 2:t.PRODUCT&&"object"==typeof t.PRODUCT?(this.showQuantity&&(this.product.checkQuantity=t.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=t.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.MAX_QUANTITY):parseInt(t.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.STEP_QUANTITY):parseInt(t.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.maxQuantity=this.product.maxQuantity,this.stepQuantity=this.product.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=t.PRODUCT.CAN_BUY,this.product.canSubscription=t.PRODUCT.SUBSCRIPTION,this.canBuy=this.product.canBuy,this.canSubscription=this.product.canSubscription,this.product.name=t.PRODUCT.NAME,this.product.pict=t.PRODUCT.PICT,this.product.id=t.PRODUCT.ID,t.PRODUCT.ADD_URL&&(this.product.addUrl=t.PRODUCT.ADD_URL),t.PRODUCT.BUY_URL&&(this.product.buyUrl=t.PRODUCT.BUY_URL),t.BASKET&&"object"==typeof t.BASKET&&(this.basketData.useProps=!!t.BASKET.ADD_PROPS,this.basketData.emptyProps=!!t.BASKET.EMPTY_PROPS)):this.errorCode=-1;break;case 3:t.OFFERS&&BX.type.isArray(t.OFFERS)?(t.PRODUCT&&"object"==typeof t.PRODUCT&&(this.product.name=t.PRODUCT.NAME,this.product.id=t.PRODUCT.ID),this.offers=t.OFFERS,this.offerNum=0,t.OFFER_SELECTED&&(this.offerNum=parseInt(t.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),t.TREE_PROPS&&(this.treeProps=t.TREE_PROPS),t.DEFAULT_PICTURE&&(this.defaultPict.pict=t.DEFAULT_PICTURE.PICTURE,this.defaultPict.secondPict=t.DEFAULT_PICTURE.PICTURE_SECOND)):this.errorCode=-1;break;default:this.errorCode=-1}t.BASKET&&"object"==typeof t.BASKET&&(t.BASKET.QUANTITY&&(this.basketData.quantity=t.BASKET.QUANTITY),t.BASKET.PROPS&&(this.basketData.props=t.BASKET.PROPS),t.BASKET.BASKET_URL&&(this.basketData.basketUrl=t.BASKET.BASKET_URL)),this.lastElement=!!t.LAST_ELEMENT&&"Y"===t.LAST_ELEMENT}0===this.errorCode&&BX.ready(BX.delegate(this.Init,this))},t.JCCatalogBigdataProducts.prototype.Init=function(){var s=0,e="",i=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPict=BX(this.visual.PICT_ID),this.obPict||(this.errorCode=-2),this.secondPict&&this.visual.SECOND_PICT_ID&&(this.obSecondPict=BX(this.visual.SECOND_PICT_ID)),this.obPrice=BX(this.visual.PRICE_ID),this.obPrice||(this.errorCode=-16),this.showQuantity&&this.visual.QUANTITY_ID&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID))),3===this.productType){if(this.visual.TREE_ID)for(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256),e=this.visual.TREE_ITEM_ID,s=0;s<this.treeProps.length;s++)if(this.obTreeRows[s]={LEFT:BX(e+this.treeProps[s].ID+"_left"),RIGHT:BX(e+this.treeProps[s].ID+"_right"),LIST:BX(e+this.treeProps[s].ID+"_list"),CONT:BX(e+this.treeProps[s].ID+"_cont")},!(this.obTreeRows[s].LEFT&&this.obTreeRows[s].RIGHT&&this.obTreeRows[s].LIST&&this.obTreeRows[s].CONT)){this.errorCode=-512;break}this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE))}if(this.visual.BUY_ID&&(this.obBuyBtn=BX(this.visual.BUY_ID)),this.showPercent&&(this.visual.DSC_PERC&&(this.obDscPerc=BX(this.visual.DSC_PERC)),this.secondPict&&this.visual.SECOND_DSC_PERC&&(this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC))),this.showSkuProps&&this.visual.DISPLAY_PROP_DIV&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)),0===this.errorCode){switch(this.showQuantity&&(this.obQuantityUp&&BX.bind(this.obQuantityUp,"click",BX.delegate(this.QuantityUp,this)),this.obQuantityDown&&BX.bind(this.obQuantityDown,"click",BX.delegate(this.QuantityDown,this)),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.QuantityChange,this))),this.productType){case 1:break;case 3:if(i=BX.findChildren(this.obTree,{tagName:"li"},!0),i&&0<i.length)for(s=0;s<i.length;s++)BX.bind(i[s],"click",BX.delegate(this.SelectOfferProp,this));for(s=0;s<this.obTreeRows.length;s++)BX.bind(this.obTreeRows[s].LEFT,"click",BX.delegate(this.RowLeft,this)),BX.bind(this.obTreeRows[s].RIGHT,"click",BX.delegate(this.RowRight,this));this.SetCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.delegate(this.Basket,this)),this.lastElement&&(this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0),this.setHeight(),BX.bind(t,"resize",BX.delegate(this.checkHeight,this)),BX.bind(this.obProduct.parentNode,"mouseover",BX.delegate(this.setHeight,this)),BX.bind(this.obProduct.parentNode,"mouseout",BX.delegate(this.clearHeight,this)))}},t.JCCatalogBigdataProducts.prototype.checkHeight=function(){this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0)},t.JCCatalogBigdataProducts.prototype.setHeight=function(){0<this.containerHeight&&BX.adjust(this.obProduct.parentNode,{style:{height:this.containerHeight+"px"}})},t.JCCatalogBigdataProducts.prototype.clearHeight=function(){BX.adjust(this.obProduct.parentNode,{style:{height:"auto"}})},t.JCCatalogBigdataProducts.prototype.QuantityUp=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,this.checkQuantity&&t>this.maxQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogBigdataProducts.prototype.QuantityDown=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&this.canBuy&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t-=this.stepQuantity,t<this.stepQuantity&&(s=!1),s&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t)))},t.JCCatalogBigdataProducts.prototype.QuantityChange=function(){var t=0,s=!0;0===this.errorCode&&this.showQuantity&&(this.canBuy?(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)?this.obQuantity.value=this.stepQuantity:(this.checkQuantity&&(t>this.maxQuantity?(s=!1,t=this.maxQuantity):t<this.stepQuantity&&(s=!1,t=this.stepQuantity)),s||(this.obQuantity.value=t))):this.obQuantity.value=this.stepQuantity)},t.JCCatalogBigdataProducts.prototype.QuantitySet=function(t){0===this.errorCode&&(this.canBuy=this.offers[t].CAN_BUY,this.canBuy?(BX.addClass(this.obBuyBtn,"bx_bt_button"),BX.removeClass(this.obBuyBtn,"bx_bt_button_type_2"),this.obBuyBtn.innerHTML=BX.message("CBD_MESS_BTN_BUY")):(BX.addClass(this.obBuyBtn,"bx_bt_button_type_2"),BX.removeClass(this.obBuyBtn,"bx_bt_button"),this.obBuyBtn.innerHTML=BX.message("CBD_MESS_NOT_AVAILABLE")),this.showQuantity&&(this.isDblQuantity=this.offers[t].QUANTITY_FLOAT,this.checkQuantity=this.offers[t].CHECK_QUANTITY,this.isDblQuantity?(this.maxQuantity=parseFloat(this.offers[t].MAX_QUANTITY),this.stepQuantity=Math.round(parseFloat(this.offers[t].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor):(this.maxQuantity=parseInt(this.offers[t].MAX_QUANTITY,10),this.stepQuantity=parseInt(this.offers[t].STEP_QUANTITY,10)),this.obQuantity.value=this.stepQuantity,this.obQuantity.disabled=!this.canBuy,this.obMeasure&&(this.offers[t].MEASURE?BX.adjust(this.obMeasure,{html:this.offers[t].MEASURE}):BX.adjust(this.obMeasure,{html:""}))))},t.JCCatalogBigdataProducts.prototype.SelectOfferProp=function(){var t=0,s="",e="",i=[],o=null,a=BX.proxy_context;if(a&&a.hasAttribute("data-treevalue")&&(e=a.getAttribute("data-treevalue"),i=e.split("_"),this.SearchOfferPropIndex(i[0],i[1])&&(o=BX.findChildren(a.parentNode,{tagName:"li"},!1),o&&0<o.length)))for(t=0;t<o.length;t++)s=o[t].getAttribute("data-onevalue"),s===i[1]?BX.addClass(o[t],"bx_active"):BX.removeClass(o[t],"bx_active")},t.JCCatalogBigdataProducts.prototype.SearchOfferPropIndex=function(t,s){var e,i,o="",a=!1,r=[],h=-1,n={},u=[];for(e=0;e<this.treeProps.length;e++)if(this.treeProps[e].ID===t){h=e;break}if(-1<h){for(e=0;e<h;e++)o="PROP_"+this.treeProps[e].ID,n[o]=this.selectedValues[o];if(o="PROP_"+this.treeProps[h].ID,a=this.GetRowValues(n,o),!a)return!1;if(!BX.util.in_array(s,a))return!1;for(n[o]=s,e=h+1;e<this.treeProps.length;e++){if(o="PROP_"+this.treeProps[e].ID,a=this.GetRowValues(n,o),!a)return!1;if(this.showAbsent)for(r=[],u=[],u=BX.clone(n,!0),i=0;i<a.length;i++)u[o]=a[i],this.GetCanBuy(u)&&(r[r.length]=a[i]);else r=a;this.selectedValues[o]&&BX.util.in_array(this.selectedValues[o],r)?n[o]=this.selectedValues[o]:n[o]=r[0],this.UpdateRow(e,n[o],a,r)}this.selectedValues=n,this.ChangeInfo()}return!0},t.JCCatalogBigdataProducts.prototype.RowLeft=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(0>this.showStart[e]&&(this.showStart[e]++,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeEnableArrow})),0<=this.showStart[e]&&BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeDisableArrow}))}},t.JCCatalogBigdataProducts.prototype.RowRight=function(){var t=0,s="",e=-1,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){for(s=i.getAttribute("data-treevalue"),t=0;t<this.treeProps.length;t++)if(this.treeProps[t].ID===s){e=t;break}-1<e&&this.treeRowShowSize<this.showCount[e]&&(this.treeRowShowSize-this.showStart[e]<this.showCount[e]&&(this.showStart[e]--,BX.adjust(this.obTreeRows[e].LIST,{style:{marginLeft:20*this.showStart[e]+"%"}}),BX.adjust(this.obTreeRows[e].LEFT,{style:this.treeEnableArrow})),this.treeRowShowSize-this.showStart[e]>=this.showCount[e]&&BX.adjust(this.obTreeRows[e].RIGHT,{style:this.treeDisableArrow}))}},t.JCCatalogBigdataProducts.prototype.UpdateRow=function(t,s,e,i){var o=0,a=0,r="",h=0,n="",u={},c=!1,l=!1,d=!1,p=0,P=this.treeEnableArrow,b=this.treeEnableArrow,B=0,f=null;if(-1<t&&t<this.obTreeRows.length&&(f=BX.findChildren(this.obTreeRows[t].LIST,{tagName:"li"},!1),f&&0<f.length)){for(c="PICT"===this.treeProps[t].SHOW_MODE,h=e.length,l=this.treeRowShowSize<h,n=l?100/h+"%":"20%",u={props:{className:""},style:{width:n}},c&&(u.style.paddingTop=n),o=0;o<f.length;o++)r=f[o].getAttribute("data-onevalue"),d=r===s,BX.util.in_array(r,i)?u.props.className=d?"bx_active":"":u.props.className=d?"bx_active bx_missing":"bx_missing",u.style.display="none",BX.util.in_array(r,e)&&(u.style.display="",d&&(p=a),a++),BX.adjust(f[o],u);u={style:{width:(l?20*h:100)+"%",marginLeft:"0%"}},c?BX.adjust(this.obTreeRows[t].CONT,{props:{className:l?"bx_item_detail_scu full":"bx_item_detail_scu"}}):BX.adjust(this.obTreeRows[t].CONT,{props:{className:l?"bx_item_detail_size full":"bx_item_detail_size"}}),l?(p+1===h&&(b=this.treeDisableArrow),this.treeRowShowSize<=p&&(B=this.treeRowShowSize-p-1,u.style.marginLeft=20*B+"%"),0===B&&(P=this.treeDisableArrow),BX.adjust(this.obTreeRows[t].LEFT,{style:P}),BX.adjust(this.obTreeRows[t].RIGHT,{style:b})):(BX.adjust(this.obTreeRows[t].LEFT,{style:{display:"none"}}),BX.adjust(this.obTreeRows[t].RIGHT,{style:{display:"none"}})),BX.adjust(this.obTreeRows[t].LIST,u),this.showCount[t]=h,this.showStart[t]=B}},t.JCCatalogBigdataProducts.prototype.GetRowValues=function(t,s){var e,i=0,o=[],a=!1,r=!0;if(0===t.length){for(i=0;i<this.offers.length;i++)BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]);a=!0}else for(i=0;i<this.offers.length;i++){for(e in r=!0,t)if(t[e]!==this.offers[i].TREE[e]){r=!1;break}r&&(BX.util.in_array(this.offers[i].TREE[s],o)||(o[o.length]=this.offers[i].TREE[s]),a=!0)}return!!a&&o},t.JCCatalogBigdataProducts.prototype.GetCanBuy=function(t){var s,e=0,i=!1,o=!0;for(e=0;e<this.offers.length;e++){for(s in o=!0,t)if(t[s]!==this.offers[e].TREE[s]){o=!1;break}if(o&&this.offers[e].CAN_BUY){i=!0;break}}return i},t.JCCatalogBigdataProducts.prototype.SetCurrent=function(){var t=0,s=0,e=[],i="",o=!1,a={},r=[],h=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(i="PROP_"+this.treeProps[t].ID,o=this.GetRowValues(a,i),o);t++){if(BX.util.in_array(h[i],o)?a[i]=h[i]:(a[i]=o[0],this.offerNum=0),this.showAbsent)for(e=[],r=[],r=BX.clone(a,!0),s=0;s<o.length;s++)r[i]=o[s],this.GetCanBuy(r)&&(e[e.length]=o[s]);else e=o;this.UpdateRow(t,a[i],o,e)}this.selectedValues=a,this.ChangeInfo()},t.JCCatalogBigdataProducts.prototype.ChangeInfo=function(){var t,s=0,e=-1,i={},o=!0,a="";for(s=0;s<this.offers.length;s++){for(t in o=!0,this.selectedValues)if(this.selectedValues[t]!==this.offers[s].TREE[t]){o=!1;break}if(o){e=s;break}}-1<e&&(this.obPict&&(this.offers[e].PREVIEW_PICTURE?BX.adjust(this.obPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE.SRC+")"}}):BX.adjust(this.obPict,{style:{backgroundImage:"url("+this.defaultPict.pict.SRC+")"}})),this.secondPict&&this.obSecondPict&&(this.offers[e].PREVIEW_PICTURE_SECOND?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE_SECOND.SRC+")"}}):this.offers[e].PREVIEW_PICTURE.SRC?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[e].PREVIEW_PICTURE.SRC+")"}}):this.defaultPict.secondPict?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.secondPict.SRC+")"}}):BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.pict.SRC+")"}})),this.showSkuProps&&this.obSkuProps&&(0===this.offers[e].DISPLAY_PROPERTIES.length?BX.adjust(this.obSkuProps,{style:{display:"none"},html:""}):BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[e].DISPLAY_PROPERTIES})),this.obPrice&&(a=this.offers[e].PRICE.PRINT_DISCOUNT_VALUE,this.showOldPrice&&this.offers[e].PRICE.DISCOUNT_VALUE!==this.offers[e].PRICE.VALUE&&(a+=" <span>"+this.offers[e].PRICE.PRINT_VALUE+"</span>"),BX.adjust(this.obPrice,{html:a}),this.showPercent&&(i=this.offers[e].PRICE.DISCOUNT_VALUE!==this.offers[e].PRICE.VALUE?{style:{display:""},html:this.offers[e].PRICE.DISCOUNT_DIFF_PERCENT}:{style:{display:"none"},html:""},this.obDscPerc&&BX.adjust(this.obDscPerc,i),this.obSecondDscPerc&&BX.adjust(this.obSecondDscPerc,i))),this.offerNum=e,this.QuantitySet(this.offerNum))},t.JCCatalogBigdataProducts.prototype.InitBasketUrl=function(){switch(this.productType){case 1:case 2:this.basketUrl=this.product.addUrl;break;case 3:this.basketUrl=this.offers[this.offerNum].ADD_URL}this.basketParams={ajax_basket:"Y",rcm:"yes"},this.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value)},t.JCCatalogBigdataProducts.prototype.FillBasketProps=function(){if(this.visual.BASKET_PROP_DIV){var t=0,s=null,e=!1,i=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(i=this.obPopupWin.contentContainer):i=BX(this.visual.BASKET_PROP_DIV),i){if(s=i.getElementsByTagName("select"),s&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"select-one":this.basketParams[s[t].name]=s[t].value,e=!0}if(s=i.getElementsByTagName("input"),s&&s.length)for(t=0;t<s.length;t++)if(!s[t].disabled)switch(s[t].type.toLowerCase()){case"hidden":this.basketParams[s[t].name]=s[t].value,e=!0;break;case"radio":s[t].checked&&(this.basketParams[s[t].name]=s[t].value,e=!0)}e||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}}},t.JCCatalogBigdataProducts.prototype.SendToBasket=function(){this.canBuy&&(this.InitBasketUrl(),this.FillBasketProps(),this.product&&this.product.id&&JCCatalogBigdataProducts.productsByRecommendation&&JCCatalogBigdataProducts.productsByRecommendation[this.product.id]&&this.RememberProductRecommendation(JCCatalogBigdataProducts.productsByRecommendation[this.product.id],this.product.id),BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.delegate(this.BasketResult,this)}))},t.JCCatalogBigdataProducts.prototype.RememberRecommendation=function(t,s){var e=BX.findParent(t,{className:"bigdata_recommended_products_items"}),i=BX.findChild(e,{attr:{name:"bigdata_recommendation_id"}},!0).value;this.RememberProductRecommendation(i,s)},t.JCCatalogBigdataProducts.prototype.RememberProductRecommendation=function(t,s){var e,i=BX.cookie_prefix+"_RCM_PRODUCT_LOG",o=getCookie(i),a=!1,r=[];o&&(r=o.split("."));for(var h=r.length;h--;)e=r[h].split("-"),e[0]==s?(e=r[h].split("-"),e[1]=t,e[2]=BX.current_server_time,r[h]=e.join("-"),a=!0):BX.current_server_time-e[2]>2592e3&&r.splice(h,1);a||r.push([s,t,BX.current_server_time].join("-"));var n=r.join("."),u=new Date((new Date).getTime()+31536e7);document.cookie=i+"="+n+"; path=/; expires="+u.toUTCString()+"; domain="+BX.cookie_domain},t.JCCatalogBigdataProducts.prototype.Basket=function(){var t="";if(this.canBuy)switch(this.productType){case 1:case 2:this.basketData.useProps&&!this.basketData.emptyProps?(this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:BX.message("CBD_TITLE_BASKET_PROPS")})}),BX(this.visual.BASKET_PROP_DIV)&&(t=BX(this.visual.BASKET_PROP_DIV).innerHTML),this.obPopupWin.setContent(t),this.obPopupWin.setButtons([new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.SendToBasket,this)}})]),this.obPopupWin.show()):this.SendToBasket();break;case 3:this.SendToBasket()}},t.JCCatalogBigdataProducts.prototype.BasketResult=function(t){var e="",i="",o="",a=!0,r=[];if(this.obPopupWin&&this.obPopupWin.close(),"object"!=typeof t)return!1;if(a="OK"===t.STATUS,a){switch(BX.onCustomEvent("OnBasketChange"),i=this.product.name,this.productType){case 1:case 2:o=this.product.pict.SRC;break;case 3:o=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC}e='<div style="width: 96%; margin: 10px 2%; text-align: center;"><img src="'+o+'" height="130" style="max-height:130px"><p>'+i+"</p></div>",r=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("CBD_BASKET_URL")},this)}})]}else e=t.MESSAGE?t.MESSAGE:BX.message("CBD_BASKET_UNKNOWN_ERROR"),r=[new s({ownerClass:this.obProduct.parentNode.parentNode.parentNode.className,text:BX.message("CBD_BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})];this.InitPopupWindow(),this.obPopupWin.setTitleBar({content:BX.create("div",{style:{marginRight:"30px",whiteSpace:"nowrap"},text:a?BX.message("CBD_TITLE_SUCCESSFUL"):BX.message("CBD_TITLE_ERROR")})}),this.obPopupWin.setContent(e),this.obPopupWin.setButtons(r),this.obPopupWin.show()},t.JCCatalogBigdataProducts.prototype.InitPopupWindow=function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}))}}})(window),BX.addCustomEvent("onSlideInit",function(t){try{if(ignoreResize.push(!0),t){var s=t.slider;s&&s.hasClass("bigdata_recommended_products_items")&&setHeightBlockSlider()}}catch(t){}finally{ignoreResize.pop()}});
/* End */
;
; /* Start:"a:4:{s:4:"full";s:86:"/bitrix/templates/aspro_max/vendor/js/carousel/owl/owl.carousel.min.js?162970272244743";s:6:"source";s:70:"/bitrix/templates/aspro_max/vendor/js/carousel/owl/owl.carousel.min.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(t,e,i,s){function n(e,i){this.settings=null,this.options=t.extend({},n.Defaults,i),this.$element=t(e),this._handlers={},this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._widths=[],this._invalidated={},this._pipe=[],this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null},this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}},t.each(["onResize","onThrottledResize"],t.proxy(function(e,i){this._handlers[i]=t.proxy(this[i],this)},this)),t.each(n.Plugins,t.proxy(function(t,e){this._plugins[t.charAt(0).toLowerCase()+t.slice(1)]=new e(this)},this)),t.each(n.Workers,t.proxy(function(e,i){this._pipe.push({filter:i.filter,run:t.proxy(i.run,this)})},this)),this.setup(),this.initialize()}n.Defaults={items:3,loop:!1,center:!1,rewind:!1,checkVisibility:!0,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:e,fallbackEasing:"swing",slideTransition:"",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"},n.Width={Default:"default",Inner:"inner",Outer:"outer"},n.Type={Event:"event",State:"state"},n.Plugins={},n.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(t){t.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(t){var e=this.settings.margin||"",i=!this.settings.autoWidth,s=this.settings.rtl,n={width:"auto","margin-left":s?e:"","margin-right":s?"":e};!i&&this.$stage.children().css(n),t.css=n}},{filter:["width","items","settings"],run:function(t){var e=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,i=null,s=this._items.length,n=!this.settings.autoWidth,o=[];for(t.items={merge:!1,width:e};s--;)i=this._mergers[s],i=this.settings.mergeFit&&Math.min(i,this.settings.items)||i,t.items.merge=i>1||t.items.merge,o[s]=n?e*i:this._items[s].width();this._widths=o}},{filter:["items","settings"],run:function(){var e=[],i=this._items,s=this.settings,n=Math.max(2*s.items,4),o=2*Math.ceil(i.length/2),r=s.loop&&i.length?s.rewind?n:Math.max(n,o):0,a="",h="";for(r/=2;r>0;)e.push(this.normalize(e.length/2,!0)),a+=i[e[e.length-1]][0].outerHTML,e.push(this.normalize(i.length-1-(e.length-1)/2,!0)),h=i[e[e.length-1]][0].outerHTML+h,r-=1;this._clones=e,t(a).addClass("cloned").appendTo(this.$stage),t(h).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){var t=this.settings.rtl?1:-1,e=this._clones.length+this._items.length,i=-1,s=0,n=0,o=[],r=!1;for(this._widths[this._widths.length-1]<this._width&&!this.settings.loop&&this.settings.lightDrag&&(r=this._width-this._widths[this._widths.length-1]);++i<e;)s=o[i-1]||0,n=this._widths[this.relative(i)]+this.settings.margin,i==e-2&&r?o.push(s+n*t+r+this.settings.margin):o.push(s+n*t);this._coordinates=o}},{filter:["width","items","settings"],run:function(){var t=this.settings.stagePadding,e=this._coordinates,i={width:Math.ceil(Math.abs(e[e.length-1]))+2*t,"padding-left":t||"","padding-right":t||""};this.$stage.css(i)}},{filter:["width","items","settings"],run:function(t){var e=this._coordinates.length,i=!this.settings.autoWidth,s=this.$stage.children();if(i&&t.items.merge)for(;e--;)t.css.width=this._widths[this.relative(e)],s.eq(e).css(t.css);else i&&(t.css.width=t.items.width,s.css(t.css))}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(t){t.current=t.current?this.$stage.children().index(t.current):0,t.current=Math.max(this.minimum(),Math.min(this.maximum(),t.current)),this.reset(t.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var t,e,i,s,n=this.settings.rtl?1:-1,o=2*this.settings.stagePadding,r=this.coordinates(this.current())+o,a=r+this.width()*n,h=[];for(i=0,s=this._coordinates.length;i<s;i++)t=this._coordinates[i-1]||0,e=Math.abs(this._coordinates[i])+o*n,(this.op(t,"<=",r)&&this.op(t,">",a)||this.op(e,"<",r)&&this.op(e,">",a))&&h.push(i);this.$stage.children(".active").removeClass("active"),this.$stage.children(":eq("+h.join("), :eq(")+")").addClass("active"),this.$stage.children(".center").removeClass("center"),this.settings.center&&this.$stage.children().eq(this.current()).addClass("center")}}],n.prototype.initializeStage=function(){this.$stage=this.$element.find("."+this.settings.stageClass),this.$stage.length||(this.$element.addClass(this.options.loadingClass),this.$stage=t("<"+this.settings.stageElement+">",{class:this.settings.stageClass}).wrap(t("<div/>",{class:this.settings.stageOuterClass})),this.$element.append(this.$stage.parent()))},n.prototype.initializeItems=function(){var e=this.$element.find(".owl-item");if(e.length)return this._items=e.get().map(function(e){return t(e)}),this._mergers=this._items.map(function(){return 1}),void this.refresh();this.replace(this.$element.children().not(this.$stage.parent())),this.isVisible()?this.refresh():this.invalidate("width"),this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass)},n.prototype.initialize=function(){var t,e,i;(this.enter("initializing"),this.trigger("initialize"),this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl),this.settings.autoWidth&&!this.is("pre-loading"))&&(t=this.$element.find("img"),e=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:s,i=this.$element.children(e).width(),t.length&&i<=0&&this.preloadAutoWidthImages(t));this.initializeStage(),this.initializeItems(),this.registerEventHandlers(),this.leave("initializing"),this.trigger("initialized")},n.prototype.isVisible=function(){return!this.settings.checkVisibility||this.$element.is(":visible")},n.prototype.setup=function(){var e=this.viewport(),i=this.options.responsive,s=-1,n=null;i?(t.each(i,function(t){t<=e&&t>s&&(s=Number(t))}),n=t.extend({},this.options,i[s]),"function"==typeof n.stagePadding&&(n.stagePadding=n.stagePadding()),delete n.responsive,n.responsiveClass&&this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+s))):n=t.extend({},this.options),this.trigger("change",{property:{name:"settings",value:n}}),this._breakpoint=s,this.settings=n,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}})},n.prototype.optionsLogic=function(){this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},n.prototype.prepare=function(e){var i=this.trigger("prepare",{content:e});return i.data||(i.data=t("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(e)),this.trigger("prepared",{content:i.data}),i.data},n.prototype.update=function(){for(var e=0,i=this._pipe.length,s=t.proxy(function(t){return this[t]},this._invalidated),n={};e<i;)(this._invalidated.all||t.grep(this._pipe[e].filter,s).length>0)&&this._pipe[e].run(n),e++;this._invalidated={},!this.is("valid")&&this.enter("valid")},n.prototype.width=function(t){switch(t=t||n.Width.Default,t){case n.Width.Inner:case n.Width.Outer:return this._width;default:return this._width-2*this.settings.stagePadding+this.settings.margin}},n.prototype.refresh=function(){this.enter("refreshing"),this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$element.addClass(this.options.refreshClass),this.update(),this.$element.removeClass(this.options.refreshClass),this.leave("refreshing"),this.trigger("refreshed")},n.prototype.onThrottledResize=function(){e.clearTimeout(this.resizeTimer),this.resizeTimer=e.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)},n.prototype.onResize=function(){return!!this._items.length&&(this._width!==this.$element.width()&&(!!this.isVisible()&&(this.enter("resizing"),this.trigger("resize").isDefaultPrevented()?(this.leave("resizing"),!1):(this.invalidate("width"),this.refresh(),this.leave("resizing"),void this.trigger("resized")))))},n.prototype.registerEventHandlers=function(){t.support.transition&&this.$stage.on(t.support.transition.end+".owl.core",t.proxy(this.onTransitionEnd,this)),!1!==this.settings.responsive&&this.on(e,"resize",this._handlers.onThrottledResize),this.settings.mouseDrag&&(this.$element.addClass(this.options.dragClass),this.$stage.on("mousedown.owl.core",t.proxy(this.onDragStart,this)),this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return!1})),this.settings.touchDrag&&(this.$stage.on("touchstart.owl.core",t.proxy(this.onDragStart,this)),this.$stage.on("touchcancel.owl.core",t.proxy(this.onDragEnd,this)))},n.prototype.onDragStart=function(e){var s=null;3!==e.which&&(this.settings.marginMove?(s=this.$stage.css("margin-left").replace("px",""),s={x:s,y:0}):t.support.transform?(s=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(","),s={x:s[16===s.length?12:4],y:s[16===s.length?13:5]}):(s=this.$stage.position(),s={x:this.settings.rtl?s.left+this.$stage.width()-this.width()+this.settings.margin:s.left,y:s.top}),this.is("animating")&&(t.support.transform?this.animate(s.x):this.$stage.stop(),this.invalidate("position")),this.$element.toggleClass(this.options.grabClass,"mousedown"===e.type),this.speed(0),this._drag.time=(new Date).getTime(),this._drag.target=t(e.target),this._drag.stage.start=s,this._drag.stage.current=s,this._drag.pointer=this.pointer(e),t(i).on("mouseup.owl.core touchend.owl.core",t.proxy(this.onDragEnd,this)),t(i).one("mousemove.owl.core touchmove.owl.core",t.proxy(function(e){var s=this.difference(this._drag.pointer,this.pointer(e));t(i).on("mousemove.owl.core touchmove.owl.core",t.proxy(this.onDragMove,this)),Math.abs(s.x)<Math.abs(s.y)&&this.is("valid")||(e.preventDefault(),this.enter("dragging"),this.trigger("drag"))},this)))},n.prototype.onDragMove=function(t){var e=null,i=null,s=null,n=this.difference(this._drag.pointer,this.pointer(t)),o=this.difference(this._drag.stage.start,n);this.is("dragging")&&(t.preventDefault(),this.settings.loop?(e=this.coordinates(this.minimum()),i=this.coordinates(this.maximum()+1)-e,o.x=((o.x-e)%i+i)%i+e):(e=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum()),i=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum()),s=this.settings.pullDrag?-1*n.x/5:0,o.x=Math.max(Math.min(o.x,e+s),i+s)),this._drag.stage.current=o,this.animate(o.x))},n.prototype.onDragEnd=function(e){var s=this.difference(this._drag.pointer,this.pointer(e)),n=this._drag.stage.current,o=s.x>0^this.settings.rtl?"left":"right";if(t(i).off(".owl.core"),this.$element.removeClass(this.options.grabClass),0!==s.x&&this.is("dragging")||!this.is("valid")){this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(this.closest(n.x,0!==s.x?o:this._drag.direction)),this.invalidate("position");var r=!1;this.settings.loop||(r=0===this.current()?n.x>0:n.x<this.coordinates()[this._items.length-1]),this.settings.lightDrag&&!r||this.update(),this._drag.direction=o,(Math.abs(s.x)>3||(new Date).getTime()-this._drag.time>300)&&this._drag.target.one("click.owl.core",function(){return!1})}this.is("dragging")&&(this.leave("dragging"),this.trigger("dragged"))},n.prototype.closest=function(e,i){var n=-1,o=30,r=this.width(),a=this.coordinates();return this.settings.freeDrag||t.each(a,t.proxy(function(t,h){return"left"===i&&e>h-o&&e<h+o?n=t:"right"===i&&e>h-r-o&&e<h-r+o?n=t+1:this.op(e,"<",h)&&this.op(e,">",a[t+1]!==s?a[t+1]:h-r)&&(n="left"===i?t+1:t),-1===n},this)),this.settings.loop||(this.op(e,">",a[this.minimum()])?n=e=this.minimum():this.op(e,"<",a[this.maximum()])&&(n=e=this.maximum())),n},n.prototype.animate=function(e){var i=this.speed()>0;this.is("animating")&&this.onTransitionEnd(),i&&(this.enter("animating"),this.trigger("translate")),this.settings.marginMove?this.$stage.css({"margin-left":e+"px",transition:this.speed()/1e3+"s"+(this.settings.slideTransition?" "+this.settings.slideTransition:"")}):t.support.transform3d&&t.support.transition?this.$stage.css({transform:"translate3d("+e+"px,0px,0px)",transition:this.speed()/1e3+"s"+(this.settings.slideTransition?" "+this.settings.slideTransition:"")}):i?this.$stage.animate({left:e+"px"},this.speed(),this.settings.fallbackEasing,t.proxy(this.onTransitionEnd,this)):this.$stage.css({left:e+"px"})},n.prototype.is=function(t){return this._states.current[t]&&this._states.current[t]>0},n.prototype.current=function(t){if(t===s)return this._current;if(0===this._items.length)return s;if(t=this.normalize(t),this._current!==t){var e=this.trigger("change",{property:{name:"position",value:t}});e.data!==s&&(t=this.normalize(e.data)),this._current=t,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current},n.prototype.invalidate=function(e){return"string"===t.type(e)&&(this._invalidated[e]=!0,this.is("valid")&&this.leave("valid")),t.map(this._invalidated,function(t,e){return e})},n.prototype.reset=function(t){t=this.normalize(t),t!==s&&(this._speed=0,this._current=t,this.suppress(["translate","translated"]),this.animate(this.coordinates(t)),this.release(["translate","translated"]))},n.prototype.normalize=function(t,e){var i=this._items.length,n=e?0:this._clones.length;return!this.isNumeric(t)||i<1?t=s:(t<0||t>=i+n)&&(t=((t-n/2)%i+i)%i+n/2),t},n.prototype.relative=function(t){return t-=this._clones.length/2,this.normalize(t,!0)},n.prototype.maximum=function(t){var e,i,s,n=this.settings,o=this._coordinates.length;if(n.loop)o=this._clones.length/2+this._items.length-1;else if(n.autoWidth||n.merge){if(e=this._items.length,e)for(i=this._items[--e].width(),s=this.$element.width();e--&&(i+=this._items[e].width()+this.settings.margin,!(i>s)););o=e+1}else o=n.center?this._items.length-1:this._items.length-n.items;return t&&(o-=this._clones.length/2),Math.max(o,0)},n.prototype.minimum=function(t){return t?0:this._clones.length/2},n.prototype.items=function(t){return t===s?this._items.slice():(t=this.normalize(t,!0),this._items[t])},n.prototype.mergers=function(t){return t===s?this._mergers.slice():(t=this.normalize(t,!0),this._mergers[t])},n.prototype.clones=function(e){var i=this._clones.length/2,n=i+this._items.length,o=function(t){return t%2==0?n+t/2:i-(t+1)/2};return e===s?t.map(this._clones,function(t,e){return o(e)}):t.map(this._clones,function(t,i){return t===e?o(i):null})},n.prototype.speed=function(t){return t!==s&&(this._speed=t),this._speed},n.prototype.coordinates=function(e){var i,n=1,o=e-1;return e===s?t.map(this._coordinates,t.proxy(function(t,e){return this.coordinates(e)},this)):(this.settings.center?(this.settings.rtl&&(n=-1,o=e+1),i=this._coordinates[e],i+=(this.width()-i+(this._coordinates[o]||0))/2*n):i=this._coordinates[o]||0,i=Math.ceil(i),i)},n.prototype.duration=function(t,e,i){return 0===i?0:Math.min(Math.max(Math.abs(e-t),1),6)*Math.abs(i||this.settings.smartSpeed)},n.prototype.to=function(t,e){var i=this.current(),s=null,n=t-this.relative(i),o=(n>0)-(n<0),r=this._items.length,a=this.minimum(),h=this.maximum();this.settings.loop?(!this.settings.rewind&&Math.abs(n)>r/2&&(n+=-1*o*r),t=i+n,s=((t-a)%r+r)%r+a,s!==t&&s-n<=h&&s-n>0&&(i=s-n,t=s,this.reset(i))):this.settings.rewind?(h+=1,t=(t%h+h)%h):t=Math.max(a,Math.min(h,t)),this.speed(this.duration(i,t,e)),this.current(t),this.isVisible()&&this.update()},n.prototype.next=function(t){t=t||!1,this.to(this.relative(this.current())+1,t)},n.prototype.prev=function(t){t=t||!1,this.to(this.relative(this.current())-1,t)},n.prototype.onTransitionEnd=function(t){if(t!==s&&(t.stopPropagation(),(t.target||t.srcElement||t.originalTarget)!==this.$stage.get(0)))return!1;this.leave("animating"),this.trigger("translated")},n.prototype.viewport=function(){var s;return this.options.responsiveBaseElement!==e?s=t(this.options.responsiveBaseElement).width():e.innerWidth?s=e.innerWidth:i.documentElement&&i.documentElement.clientWidth?s=i.documentElement.clientWidth:console.warn("Can not detect viewport width."),s},n.prototype.replace=function(e){this.$stage.empty(),this._items=[],e&&(e=e instanceof jQuery?e:t(e)),this.settings.nestedItemSelector&&(e=e.find("."+this.settings.nestedItemSelector)),e.filter(function(){return 1===this.nodeType}).each(t.proxy(function(t,e){e=this.prepare(e),this.$stage.append(e),this._items.push(e),this._mergers.push(1*e.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)},this)),this.reset(this.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},n.prototype.add=function(e,i){var n=this.relative(this._current);i=i===s?this._items.length:this.normalize(i,!0),e=e instanceof jQuery?e:t(e),this.trigger("add",{content:e,position:i}),e=this.prepare(e),0===this._items.length||i===this._items.length?(0===this._items.length&&this.$stage.append(e),0!==this._items.length&&this._items[i-1].after(e),this._items.push(e),this._mergers.push(1*e.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)):(this._items[i].before(e),this._items.splice(i,0,e),this._mergers.splice(i,0,1*e.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)),this._items[n]&&this.reset(this._items[n].index()),this.invalidate("items"),this.trigger("added",{content:e,position:i})},n.prototype.remove=function(t){t=this.normalize(t,!0),t!==s&&(this.trigger("remove",{content:this._items[t],position:t}),this._items[t].remove(),this._items.splice(t,1),this._mergers.splice(t,1),this.invalidate("items"),this.trigger("removed",{content:null,position:t}))},n.prototype.preloadAutoWidthImages=function(e){e.each(t.proxy(function(e,i){this.enter("pre-loading"),i=t(i),t(new Image).one("load",t.proxy(function(t){i.attr("src",t.target.src),i.css("opacity",1),this.leave("pre-loading"),!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",i.attr("src")||i.attr("data-src")||i.attr("data-src-retina"))},this))},n.prototype.destroy=function(){for(var s in this.$element.off(".owl.core"),this.$stage.off(".owl.core"),t(i).off(".owl.core"),!1!==this.settings.responsive&&(e.clearTimeout(this.resizeTimer),this.off(e,"resize",this._handlers.onThrottledResize)),this._plugins)this._plugins[s].destroy();this.$stage.children(".cloned").remove(),this.$stage.unwrap(),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$stage.remove(),this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")},n.prototype.op=function(t,e,i){var s=this.settings.rtl;switch(e){case"<":return s?t>i:t<i;case">":return s?t<i:t>i;case">=":return s?t<=i:t>=i;case"<=":return s?t>=i:t<=i}},n.prototype.on=function(t,e,i,s){t.addEventListener?t.addEventListener(e,i,s):t.attachEvent&&t.attachEvent("on"+e,i)},n.prototype.off=function(t,e,i,s){t.removeEventListener?t.removeEventListener(e,i,s):t.detachEvent&&t.detachEvent("on"+e,i)},n.prototype.trigger=function(e,i,s,o,r){var a={item:{count:this._items.length,index:this.current()}},h=t.camelCase(t.grep(["on",e,s],function(t){return t}).join("-").toLowerCase()),l=t.Event([e,"owl",s||"carousel"].join(".").toLowerCase(),t.extend({relatedTarget:this},a,i));return this._supress[e]||(t.each(this._plugins,function(t,e){e.onTrigger&&e.onTrigger(l)}),this.register({type:n.Type.Event,name:e}),this.$element.trigger(l),this.settings&&"function"==typeof this.settings[h]&&this.settings[h].call(this,l)),l},n.prototype.enter=function(e){t.each([e].concat(this._states.tags[e]||[]),t.proxy(function(t,e){this._states.current[e]===s&&(this._states.current[e]=0),this._states.current[e]++},this))},n.prototype.leave=function(e){t.each([e].concat(this._states.tags[e]||[]),t.proxy(function(t,e){this._states.current[e]--},this))},n.prototype.register=function(e){if(e.type===n.Type.Event){if(t.event.special[e.name]||(t.event.special[e.name]={}),!t.event.special[e.name].owl){var i=t.event.special[e.name]._default;t.event.special[e.name]._default=function(t){return!i||!i.apply||t.namespace&&-1!==t.namespace.indexOf("owl")?t.namespace&&t.namespace.indexOf("owl")>-1:i.apply(this,arguments)},t.event.special[e.name].owl=!0}}else e.type===n.Type.State&&(this._states.tags[e.name]?this._states.tags[e.name]=this._states.tags[e.name].concat(e.tags):this._states.tags[e.name]=e.tags,this._states.tags[e.name]=t.grep(this._states.tags[e.name],t.proxy(function(i,s){return t.inArray(i,this._states.tags[e.name])===s},this)))},n.prototype.suppress=function(e){t.each(e,t.proxy(function(t,e){this._supress[e]=!0},this))},n.prototype.release=function(e){t.each(e,t.proxy(function(t,e){delete this._supress[e]},this))},n.prototype.pointer=function(t){var i={x:null,y:null};return t=t.originalEvent||t||e.event,t=t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t.pageX?(i.x=t.pageX,i.y=t.pageY):(i.x=t.clientX,i.y=t.clientY),i},n.prototype.isNumeric=function(t){return!isNaN(parseFloat(t))},n.prototype.difference=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},t.fn.owlCarousel=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var s=t(this),o=s.data("owl.carousel");o||(o=new n(this,"object"==typeof e&&e),s.data("owl.carousel",o),t.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(e,i){o.register({type:n.Type.Event,name:i}),o.$element.on(i+".owl.carousel.core",t.proxy(function(t){t.namespace&&t.relatedTarget!==this&&(this.suppress([i]),o[i].apply(this,[].slice.call(arguments,1)),this.release([i]))},o))})),"string"==typeof e&&"_"!==e.charAt(0)&&o[e].apply(o,i)})},t.fn.owlCarousel.Constructor=n})(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(e){this._core=e,this._interval=null,this._visible=null,this._handlers={"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoRefresh&&this.watch()},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers)};n.Defaults={autoRefresh:!0,autoRefreshInterval:500},n.prototype.watch=function(){this._interval||(this._visible=this._core.isVisible(),this._interval=e.setInterval(t.proxy(this.refresh,this),this._core.settings.autoRefreshInterval))},n.prototype.refresh=function(){this._core.isVisible()!==this._visible&&(this._visible=!this._visible,this._core.$element.toggleClass("owl-hidden",!this._visible),this._visible&&this._core.invalidate("width")&&this._core.refresh())},n.prototype.destroy=function(){var t,i;for(t in e.clearInterval(this._interval),this._handlers)this._core.$element.off(t,this._handlers[t]);for(i in Object.getOwnPropertyNames(this))"function"!=typeof this[i]&&(this[i]=null)},t.fn.owlCarousel.Constructor.Plugins.AutoRefresh=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(e){this._core=e,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel resized.owl.carousel":t.proxy(function(e){if(e.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(e.property&&"position"==e.property.name||"initialized"==e.type)){var i=this._core.settings,n=i.center&&Math.ceil(i.items/2)||i.items,o=i.center&&-1*n||0,r=(e.property&&e.property.value!==s?e.property.value:this._core.current())+o,a=this._core.clones().length,h=t.proxy(function(t,e){this.load(e)},this);for(i.lazyLoadEager>0&&(n+=i.lazyLoadEager,i.loop&&(r-=i.lazyLoadEager,n++));o++<n;)this.load(a/2+this._core.relative(r)),a&&t.each(this._core.clones(this._core.relative(r)),h),r++}},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers)};n.Defaults={lazyLoad:!1,lazyLoadEager:0},n.prototype.load=function(i){var s=this._core.$stage.children().eq(i),n=s&&s.find(".owl-lazy");!n||t.inArray(s.get(0),this._loaded)>-1||(n.each(t.proxy(function(i,s){var n,o=t(s),r=e.devicePixelRatio>1&&o.attr("data-src-retina")||o.attr("data-src")||o.attr("data-srcset");this._core.trigger("load",{element:o,url:r},"lazy"),o.is("img")?o.one("load.owl.lazy",t.proxy(function(){o.css("opacity",1),this._core.trigger("loaded",{element:o,url:r},"lazy")},this)).attr("src",r):o.is("source")?o.one("load.owl.lazy",t.proxy(function(){this._core.trigger("loaded",{element:o,url:r},"lazy")},this)).attr("srcset",r):(n=new Image,n.onload=t.proxy(function(){o.css({"background-image":'url("'+r+'")',opacity:"1"}),this._core.trigger("loaded",{element:o,url:r},"lazy")},this),n.src=r)},this)),this._loaded.push(s.get(0)))},n.prototype.destroy=function(){var t,e;for(t in this.handlers)this._core.$element.off(t,this.handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Lazy=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(i){this._core=i,this._previousHeight=null,this._handlers={"initialized.owl.carousel refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&"position"===t.property.name&&this.update()},this),"loaded.owl.lazy":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&t.element.closest("."+this._core.settings.itemClass).index()===this._core.current()&&this.update()},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers),this._intervalId=null;var s=this;t(e).on("load",function(){s._core.settings.autoHeight&&s.update()}),t(e).resize(function(){s._core.settings.autoHeight&&(null!=s._intervalId&&clearTimeout(s._intervalId),s._intervalId=setTimeout(function(){s.update()},250))})};n.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},n.prototype.update=function(){var e=this._core._current,i=e+this._core.settings.items,s=this._core.settings.lazyLoad,n=this._core.$stage.children().toArray().slice(e,i),o=[],r=0;t.each(n,function(e,i){o.push(t(i).height())}),r=Math.max.apply(null,o),r<=1&&s&&this._previousHeight&&(r=this._previousHeight),this._previousHeight=r,this._core.$stage.parent().height(r).addClass(this._core.settings.autoHeightClass)},n.prototype.destroy=function(){var t,e;for(t in this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.AutoHeight=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(e){this._core=e,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.register({type:"state",name:"playing",tags:["interacting"]})},this),"resize.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.video&&this.isInFullScreen()&&t.preventDefault()},this),"refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.is("resizing")&&this._core.$stage.find(".cloned .owl-video-frame").remove()},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&"position"===t.property.name&&this._playing&&this.stop()},this),"prepared.owl.carousel":t.proxy(function(e){if(e.namespace){var i=t(e.content).find(".owl-video");i.length&&(i.css("display","none"),this.fetch(i,t(e.content)))}},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",t.proxy(function(t){this.play(t)},this))};n.Defaults={video:!1,videoHeight:!1,videoWidth:!1},n.prototype.fetch=function(t,e){var i=t.attr("data-vimeo-id")?"vimeo":t.attr("data-vzaar-id")?"vzaar":"youtube",s=t.attr("data-vimeo-id")||t.attr("data-youtube-id")||t.attr("data-vzaar-id"),n=t.attr("data-width")||this._core.settings.videoWidth,o=t.attr("data-height")||this._core.settings.videoHeight,r=t.attr("href");if(!r)throw new Error("Missing video URL.");if(s=r.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),s[3].indexOf("youtu")>-1)i="youtube";else if(s[3].indexOf("vimeo")>-1)i="vimeo";else{if(!(s[3].indexOf("vzaar")>-1))throw new Error("Video URL not supported.");i="vzaar"}s=s[6],this._videos[r]={type:i,id:s,width:n,height:o},e.attr("data-video",r),this.thumbnail(t,this._videos[r])},n.prototype.thumbnail=function(e,i){var s,n,o,r=i.width&&i.height?"width:"+i.width+"px;height:"+i.height+"px;":"",a=e.find("img"),h="src",l="",c=this._core.settings,p=function(i){n='<div class="owl-video-play-icon"></div>',s=c.lazyLoad?t("<div/>",{class:"owl-video-tn "+l,srcType:i}):t("<div/>",{class:"owl-video-tn",style:"opacity:1;background-image:url("+i+")"}),e.after(s),e.after(n)};if(e.wrap(t("<div/>",{class:"owl-video-wrapper",style:r})),this._core.settings.lazyLoad&&(h="data-src",l="owl-lazy"),a.length)return p(a.attr(h)),a.remove(),!1;"youtube"===i.type?(o="//img.youtube.com/vi/"+i.id+"/hqdefault.jpg",p(o)):"vimeo"===i.type?t.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+i.id+".json",jsonp:"callback",dataType:"jsonp",success:function(t){o=t[0].thumbnail_large,p(o)}}):"vzaar"===i.type&&t.ajax({type:"GET",url:"//vzaar.com/api/videos/"+i.id+".json",jsonp:"callback",dataType:"jsonp",success:function(t){o=t.framegrab_url,p(o)}})},n.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null,this._core.leave("playing"),this._core.trigger("stopped",null,"video")},n.prototype.play=function(e){var i,s=t(e.target),n=s.closest("."+this._core.settings.itemClass),o=this._videos[n.attr("data-video")],r=o.width||"100%",a=o.height||this._core.$stage.height();this._playing||(this._core.enter("playing"),this._core.trigger("play",null,"video"),n=this._core.items(this._core.relative(n.index())),this._core.reset(n.index()),i=t('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>'),i.attr("height",a),i.attr("width",r),"youtube"===o.type?i.attr("src","//www.youtube.com/embed/"+o.id+"?autoplay=1&rel=0&v="+o.id):"vimeo"===o.type?i.attr("src","//player.vimeo.com/video/"+o.id+"?autoplay=1"):"vzaar"===o.type&&i.attr("src","//view.vzaar.com/"+o.id+"/player?autoplay=true"),t(i).wrap('<div class="owl-video-frame" />').insertAfter(n.find(".owl-video")),this._playing=n.addClass("owl-video-playing"))},n.prototype.isInFullScreen=function(){var e=i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement;return e&&t(e).parent().hasClass("owl-video-frame")},n.prototype.destroy=function(){var t,e;for(t in this._core.$element.off("click.owl.video"),this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Video=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(e){this.core=e,this.core.options=t.extend({},n.Defaults,this.core.options),
this.swapping=!0,this.previous=s,this.next=s,this.handlers={"change.owl.carousel":t.proxy(function(t){t.namespace&&"position"==t.property.name&&(this.previous=this.core.current(),this.next=t.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":t.proxy(function(t){t.namespace&&(this.swapping="translated"==t.type)},this),"translate.owl.carousel":t.proxy(function(t){t.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};n.Defaults={animateOut:!1,animateIn:!1},n.prototype.swap=function(){if(1===this.core.settings.items&&t.support.animation&&t.support.transition){this.core.speed(0);var e,i=t.proxy(this.clear,this),s=this.core.$stage.children().eq(this.previous),n=this.core.$stage.children().eq(this.next),o=this.core.settings.animateIn,r=this.core.settings.animateOut;this.core.current()!==this.previous&&(r&&(e=this.core.coordinates(this.previous)-this.core.coordinates(this.next),s.one(t.support.animation.end,i).css({left:e+"px"}).addClass("animated owl-animated-out").addClass(r)),o&&n.one(t.support.animation.end,i).addClass("animated owl-animated-in").addClass(o))}},n.prototype.clear=function(e){t(e.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.onTransitionEnd()},n.prototype.destroy=function(){var t,e;for(t in this.handlers)this.core.$element.off(t,this.handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Animate=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){var n=function(e){this._core=e,this._call=null,this._time=0,this._timeout=0,this._paused=!0,this._handlers={"changed.owl.carousel":t.proxy(function(t){t.namespace&&"settings"===t.property.name?this._core.settings.autoplay?this.play():this.stop():t.namespace&&"position"===t.property.name&&this._paused&&(this._time=0)},this),"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoplay&&this.play()},this),"play.owl.autoplay":t.proxy(function(t,e,i){t.namespace&&this.play(e,i)},this),"stop.owl.autoplay":t.proxy(function(t){t.namespace&&this.stop()},this),"mouseover.owl.autoplay":t.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"mouseleave.owl.autoplay":t.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.play()},this),"touchstart.owl.core":t.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"touchend.owl.core":t.proxy(function(){this._core.settings.autoplayHoverPause&&this.play()},this)},this._core.$element.on(this._handlers),this._core.options=t.extend({},n.Defaults,this._core.options)};n.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},n.prototype._next=function(s){this._call=e.setTimeout(t.proxy(this._next,this,s),this._timeout*(Math.round(this.read()/this._timeout)+1)-this.read()),this._core.is("interacting")||i.hidden||this._core.next(s||this._core.settings.autoplaySpeed)},n.prototype.read=function(){return(new Date).getTime()-this._time},n.prototype.play=function(i,s){var n;this._core.is("rotating")||this._core.enter("rotating"),i=i||this._core.settings.autoplayTimeout,n=Math.min(this._time%(this._timeout||i),i),this._paused?(this._time=this.read(),this._paused=!1):e.clearTimeout(this._call),this._time+=this.read()%i-n,this._timeout=i,this._call=e.setTimeout(t.proxy(this._next,this,s),i-n)},n.prototype.stop=function(){this._core.is("rotating")&&(this._time=0,this._paused=!0,e.clearTimeout(this._call),this._core.leave("rotating"))},n.prototype.pause=function(){this._core.is("rotating")&&!this._paused&&(this._time=this.read(),this._paused=!0,e.clearTimeout(this._call))},n.prototype.destroy=function(){var t,e;for(t in this.stop(),this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.autoplay=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){"use strict";var n=function(e){this._core=e,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":t.proxy(function(e){e.namespace&&this._core.settings.dotsData&&this._templates.push('<div class="'+this._core.settings.dotClass+'">'+t(e.content).find("[data-dot]").addBack("[data-dot]").attr("data-dot")+"</div>")},this),"added.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.dotsData&&this._templates.splice(t.position,0,this._templates.pop())},this),"remove.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.dotsData&&this._templates.splice(t.position,1)},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&"position"==t.property.name&&this.draw()},this),"initialized.owl.carousel":t.proxy(function(t){t.namespace&&!this._initialized&&(this._core.trigger("initialize",null,"navigation"),this.initialize(),this.update(),this.draw(),this._initialized=!0,this._core.trigger("initialized",null,"navigation"))},this),"refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._initialized&&(this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation"))},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this.$element.on(this._handlers)};n.Defaults={nav:!1,navText:['<span aria-label="Previous">&#x2039;</span>','<span aria-label="Next">&#x203a;</span>'],navSpeed:!1,navElement:'button type="button" role="presentation"',navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotsData:!1,dotsSpeed:!1,dotsContainer:!1},n.prototype.initialize=function(){var e,i=this._core.settings;for(e in this._controls.$relative=(i.navContainer?t(i.navContainer):t("<div>").addClass(i.navContainerClass).appendTo(this.$element)).addClass("disabled"),this._controls.$previous=t("<"+i.navElement+">").addClass(i.navClass[0]).html(i.navText[0]).prependTo(this._controls.$relative).on("click",t.proxy(function(t){this.prev(i.navSpeed)},this)),this._controls.$next=t("<"+i.navElement+">").addClass(i.navClass[1]).html(i.navText[1]).appendTo(this._controls.$relative).on("click",t.proxy(function(t){this.next(i.navSpeed)},this)),i.dotsData||(this._templates=[t('<button role="button">').addClass(i.dotClass).append(t("<span>")).prop("outerHTML")]),this._controls.$absolute=(i.dotsContainer?t(i.dotsContainer):t("<div>").addClass(i.dotsClass).appendTo(this.$element)).addClass("disabled"),this._controls.$absolute.on("click","button",t.proxy(function(e){var s=t(e.target).parent().is(this._controls.$absolute)?t(e.target).index():t(e.target).parent().index();e.preventDefault(),this.to(s,i.dotsSpeed)},this)),this._overrides)this._core[e]=t.proxy(this[e],this)},n.prototype.destroy=function(){var t,e,i,s,n;for(t in n=this._core.settings,this._handlers)this.$element.off(t,this._handlers[t]);for(e in this._controls)"$relative"===e&&n.navContainer?this._controls[e].html(""):this._controls[e].remove();for(s in this.overides)this._core[s]=this._overrides[s];for(i in Object.getOwnPropertyNames(this))"function"!=typeof this[i]&&(this[i]=null)},n.prototype.update=function(){var t,e,i=this._core.clones().length/2,s=i+this._core.items().length,n=this._core.maximum(!0),o=this._core.settings,r=o.center||o.autoWidth||o.dotsData?1:o.dotsEach||o.items;if("page"!==o.slideBy&&(o.slideBy=Math.min(o.slideBy,o.items)),o.dots||"page"==o.slideBy)for(this._pages=[],t=i,e=0,0;t<s;t++){if(e>=r||0===e){if(this._pages.push({start:Math.min(n,t-i),end:t-i+r-1}),Math.min(n,t-i)===n)break;e=0,0}e+=this._core.mergers(this._core.relative(t))}},n.prototype.draw=function(){var e,i=this._core.settings,s=this._core.items().length<=i.items,n=this._core.relative(this._core.current()),o=i.loop||i.rewind;this._controls.$relative.toggleClass("disabled",!i.nav||s),i.nav&&(this._controls.$previous.toggleClass("disabled",!o&&n<=this._core.minimum(!0)),this._controls.$next.toggleClass("disabled",!o&&n>=this._core.maximum(!0))),this._controls.$absolute.toggleClass("disabled",!i.dots||s),i.dots&&(e=this._pages.length-this._controls.$absolute.children().length,i.dotsData&&0!==e?this._controls.$absolute.html(this._templates.join("")):e>0?this._controls.$absolute.append(new Array(e+1).join(this._templates[0])):e<0&&this._controls.$absolute.children().slice(e).remove(),this._controls.$absolute.find(".active").removeClass("active"),this._controls.$absolute.children().eq(t.inArray(this.current(),this._pages)).addClass("active"))},n.prototype.onTrigger=function(e){var i=this._core.settings;e.page={index:t.inArray(this.current(),this._pages),count:this._pages.length,size:i&&(i.center||i.autoWidth||i.dotsData?1:i.dotsEach||i.items)}},n.prototype.current=function(){var e=this._core.relative(this._core.current());return t.grep(this._pages,t.proxy(function(t,i){return t.start<=e&&t.end>=e},this)).pop()},n.prototype.getPosition=function(e){var i,s,n=this._core.settings;return"page"==n.slideBy?(i=t.inArray(this.current(),this._pages),s=this._pages.length,e?++i:--i,i=this._pages[(i%s+s)%s].start):(i=this._core.relative(this._core.current()),s=this._core.items().length,e?i+=n.slideBy:i-=n.slideBy),i},n.prototype.next=function(e){t.proxy(this._overrides.to,this._core)(this.getPosition(!0),e)},n.prototype.prev=function(e){t.proxy(this._overrides.to,this._core)(this.getPosition(!1),e)},n.prototype.to=function(e,i,s){var n;!s&&this._pages.length?(n=this._pages.length,t.proxy(this._overrides.to,this._core)(this._pages[(e%n+n)%n].start,i)):t.proxy(this._overrides.to,this._core)(e,i)},t.fn.owlCarousel.Constructor.Plugins.Navigation=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){"use strict";var n=function(i){this._core=i,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":t.proxy(function(i){i.namespace&&"URLHash"===this._core.settings.startPosition&&t(e).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":t.proxy(function(e){if(e.namespace){var i=t(e.content).find("[data-hash]").addBack("[data-hash]").attr("data-hash");if(!i)return;this._hashes[i]=e.content}},this),"changed.owl.carousel":t.proxy(function(i){if(i.namespace&&"position"===i.property.name){var s=this._core.items(this._core.relative(this._core.current())),n=t.map(this._hashes,function(t,e){return t===s?e:null}).join();if(!n||e.location.hash.slice(1)===n)return;e.location.hash=n}},this)},this._core.options=t.extend({},n.Defaults,this._core.options),this.$element.on(this._handlers),t(e).on("hashchange.owl.navigation",t.proxy(function(t){var i=e.location.hash.substring(1),n=this._core.$stage.children(),o=this._hashes[i]&&n.index(this._hashes[i]);o!==s&&o!==this._core.current()&&this._core.to(this._core.relative(o),!1,!0)},this))};n.Defaults={URLhashListener:!1},n.prototype.destroy=function(){var i,s;for(i in t(e).off("hashchange.owl.navigation"),this._handlers)this._core.$element.off(i,this._handlers[i]);for(s in Object.getOwnPropertyNames(this))"function"!=typeof this[s]&&(this[s]=null)},t.fn.owlCarousel.Constructor.Plugins.Hash=n}(window.Zepto||window.jQuery,window,document),function(t,e,i,s){function n(e,i){var n=!1,o=e.charAt(0).toUpperCase()+e.slice(1);return t.each((e+" "+a.join(o+" ")+o).split(" "),function(t,e){if(r[e]!==s)return n=!i||e,!1}),n}function o(t){return n(t,!0)}var r=t("<support>").get(0).style,a="Webkit Moz O ms".split(" "),h={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},l={csstransforms:function(){return!!n("transform")},csstransforms3d:function(){return!!n("perspective")},csstransitions:function(){return!!n("transition")},cssanimations:function(){return!!n("animation")}};l.csstransitions()&&(t.support.transition=new String(o("transition")),t.support.transition.end=h.transition.end[t.support.transition]),l.cssanimations()&&(t.support.animation=new String(o("animation")),t.support.animation.end=h.animation.end[t.support.animation]),l.csstransforms()&&(t.support.transform=new String(o("transform")),t.support.transform3d=l.csstransforms3d())}(window.Zepto||window.jQuery,window,document);
/* End */
;; /* /bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/mustache.min.js?16297027225835*/
; /* /bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/action-pool.min.js?16297027224358*/
; /* /bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/filter.min.js?162970272210511*/
; /* /bitrix/templates/aspro_max/components/bitrix/sale.basket.basket/v1/js/component.min.js?162970272248354*/
; /* /bitrix/templates/aspro_max/components/bitrix/catalog.bigdata.products/main/script.min.js?162970272223267*/
; /* /bitrix/templates/aspro_max/vendor/js/carousel/owl/owl.carousel.min.js?162970272244743*/

//# sourceMappingURL=page_fed224a63a0276d06981a24cc4b5acad.map.js